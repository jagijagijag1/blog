[{"title":"Qrunchè¨˜äº‹ã®Hugo on GitHub Pagesç§»è¡Œã¨Hugoãƒ†ãƒ¼ãƒæ‹¡å¼µ","date":"","description":"","body":" Hugo on GitHub Pagesã®æ§‹æˆ  ç§»è¡Œã—ãŸã¨ãã®ã¤ã¾ã¥ã  ç”»åƒãƒªãƒ³ã‚¯ä¿®æ­£     ãƒ†ãƒ¼ãƒHugo Future Imperfect Slimã®æ‹¡å¼µ  cssã®ä¸Šæ›¸ã ãƒ–ãƒ­ã‚°ãƒ‘ãƒ¼ãƒ„ã®è¨­ç½®  æ‹æ‰‹ãƒœã‚¿ãƒ³ ã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ Pixelaãƒ¦ãƒ¼ã‚¶ãƒšãƒ¼ã‚¸ã®socal icon       é–‰é–ã—ã¦ã—ã¾ã†Qrunchã§æ›¸ã„ãŸè¨˜äº‹ã‚’GitHub Pagesã«ç§»è¡Œã—ãŸã®ã¨ï¼Œé¸ã‚“ã Hugoãƒ†ãƒ¼ãƒã‚’å°‘ã—æ‹¡å¼µã—ãŸã®ã§ï¼Œãã®ã¨ãã«ã‚„ã£ãŸã“ã¨ã‚’æ›¸ãç•™ã‚ï¼\n ã“ã®ãƒ–ãƒ­ã‚°ã®Hugoã‚½ãƒ¼ã‚¹ã¯â†’GitHub - jagijagijag1/blog at source ã“ã®ãƒ–ãƒ­ã‚°ç”¨ã«æ‹¡å¼µã—ãŸãƒ†ãƒ¼ãƒã¯â†’GitHub - jagijagijag1/hugo-future-imperfect-slim at add-pixela-social  Hugo on GitHub Pagesã®æ§‹æˆ  QrunchãŒé–‰é–ã™ã‚‹ãŸã‚ç§»è¡Œå…ˆã¨ã—ã¦GitHub Pagesã‚’é¸æŠ  Qrunchä»¥ä¸Šã«åˆã„ãã†ãªã‚µãƒ¼ãƒ“ã‚¹ãŒãªã‹ã£ãŸãŸã‚   ãƒ–ãƒ­ã‚°ã¯GitHubãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ(not ãƒ¦ãƒ¼ã‚¶)ã«ç´ã¥ãGitHub Pagesã‚’åˆ©ç”¨ (https://\u0026lt;user-name\u0026gt;.github.io/\u0026lt;repository-name\u0026gt;ã«ãƒ›ã‚¹ãƒˆ)  ãƒ–ãƒ­ã‚°å˜å“ã¨ã—ã¦ãƒ›ã‚¹ãƒˆã—ãŸã„ã®ã§ï¼Œãƒªãƒã‚¸ãƒˆãƒªåã‚’blogã«ã—ã¦ä½œæˆ masterãƒ–ãƒ©ãƒ³ãƒã®docsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ã‚ˆã†è¨­å®š   sourceãƒ–ãƒ©ãƒ³ãƒã«ã¦Hugoãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç®¡ç† + sourceãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§èµ·å‹•ã™ã‚‹GitHub Actionsã‚’è¨­å®šã—masterãƒ–ãƒ©ãƒ³ãƒã«Hugoã®é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆçµæœã‚’push  name: build hugo site on source \u0026amp; deploy to master on: push: branches: - source jobs: deploy: runs-on: ubuntu-18.04 steps: - uses: actions/checkout@v2 with: submodules: true fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#39;0.75.1\u0026#39; - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_branch: master publish_dir: ./docs destination_dir: ./docs ç§»è¡Œã—ãŸã¨ãã®ã¤ã¾ã¥ã  Qrunchã¯Markdownã§è¨˜è¿°å¯èƒ½ã§ã‚ã£ãŸãŸã‚ï¼ŒExportã—ã¦ããŸè¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®ä¿®æ­£ç‚¹ã¯å¤§ããä¸‹è¨˜2ã¤  ãƒ˜ãƒƒãƒ€æƒ…å ±ã®ä¿®æ­£ (dateã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãªã©ã‚’ã‚„ã‚‹ã ã‘) æœ¬æ–‡ä¸­ã®ç”»åƒãƒªãƒ³ã‚¯ (è‹¥å¹²ã¤ã¾ã¥ã„ãŸã®ã§å¾Œè¿°)    ç”»åƒãƒªãƒ³ã‚¯ä¿®æ­£  Hugoä¸Šã§ã®è¨˜äº‹ç®¡ç†ã¯ä¸‹è¨˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã«ã—ãŸ  ... â”œâ”€â”€ content | â”œâ”€â”€ posts | | â”œâ”€â”€ 20xx_xx_xx | | | â”œâ”€â”€ xxxxxxx.png | | | â””â”€â”€ index.md | | â”œâ”€â”€ 20xx_xx_xx | | | â”œâ”€â”€ xxxxxxx.png | | | â””â”€â”€ index.md | | | ...  ã¾ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç´ã¥ãGitHub Pagesã‚’åˆ©ç”¨ã—ãŸãŸã‚ï¼ŒHugoã®è¨­å®šã§base urlã‚’è¨­å®š  baseURL = \u0026#34;http://jagijagijag1.github.io/blog/\u0026#34; publishDir = \u0026#34;docs\u0026#34; ...  ä¸Šè¨˜è¨­å®šã®å ´åˆï¼Œç”»åƒãƒªãƒ³ã‚¯ã¯ä¸‹è¨˜ã®é€šã‚Šä¿®æ­£ã—ã¦è§£æ±º  ä¿®æ­£å‰: [image](https://s3.qrunch.io/xxxxxxx.png) ä¿®æ­£å¾Œ: [image](/blog/posts/20xx_xx_xx/xxxxxxx.png)  [image](xxxxxxx.png)ã§æŒ‡å®šã™ã‚‹ã¨ï¼Œè¨˜äº‹ä¸­ã§ã¯æ­£å¸¸ã«ç”»åƒè¡¨ç¤ºã•ã‚Œã‚‹ãŒï¼Œè¨˜äº‹ä¸€è¦§ãƒšãƒ¼ã‚¸ã‹ã‚‰ã ã¨ãƒªãƒ³ã‚¯ãŒãŠã‹ã—ããªã£ã¦ç”»åƒè¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸ      (ã“ã“ã«ãŸã©ã‚Šç€ãã¾ã§ã©ã†ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒã„ã„ã‹ã¨ã‹ï¼Œbase urlå¤‰ãˆãŸæ™‚ã«ã©ã†ç”»åƒãƒªãƒ³ã‚¯æŒ‡å®šã™ã‚‹ã‹ãŒã‚ˆãã‚ã‹ã‚‰ãšå››è‹¦å…«è‹¦ã—ãŸâ€¦)\nãƒ†ãƒ¼ãƒHugo Future Imperfect Slimã®æ‹¡å¼µ  é¸ã‚“ã ãƒ†ãƒ¼ãƒã‚’å°‘ã—æ”¹å–„ãƒ»æ‹¡å¼µ  cssã®ä¸Šæ›¸ã  static/css/add-on.cssã«è¨˜è¿°ã—ãŸå†…å®¹ã¯ï¼Œãƒ†ãƒ¼ãƒã®CSSã‚’ä¸Šæ›¸ãã—ã¦ãã‚Œã‚‹ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨æ–‡å­—é–“éš”ã‚„ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒ•ã‚©ãƒ³ãƒˆãªã©ãŒå°‘ã—æ°—ã«å…¥ã‚‰ãªã‹ã£ãŸã®ã§ä¸‹è¨˜ã®ã‚ˆã†ã«ä¿®æ­£  #site-sidebar ul, .stats ul li { text-transform: none; } .nav { text-transform: none; letter-spacing: 0.2em; } h1, h2, h3, h4, h5, h6 { text-transform: none; letter-spacing: 0.1em; } code { font-family: Monaco, Inconsolata, Consolas, monospace; } .count-container \u0026gt; .count { font-family: Monaco, Inconsolata, Consolas, monospace; } ãƒ–ãƒ­ã‚°ãƒ‘ãƒ¼ãƒ„ã®è¨­ç½®  Hugo Future Imperfect Slimã®ãƒªãƒã‚¸ãƒˆãƒªã‚’forkã—ã¦æ‹¡å¼µ  Hugoã§ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã§ãƒ†ãƒ¼ãƒå–å¾—ã—ã¦config.tomlã§ãƒ†ãƒ¼ãƒæŒ‡å®š+å„ãƒ‘ãƒ¼ãƒ„ã®ãƒ‘ãƒ©ãƒ¡ã‚¿æŒ‡å®šã™ã‚Œã°åˆ©ç”¨å¯èƒ½ git submodule add -b add-pixela-social https://github.com/jagijagijag1/hugo-future-imperfect-slim.git themes/hugo-future-imperfect-slim    æ‹æ‰‹ãƒœã‚¿ãƒ³  Qrunchã«ã¯ã‚ã£ãŸæ‹æ‰‹ãƒœã‚¿ãƒ³ã‚’ã“ã£ã¡ã«ã‚‚ä¸€å¿œã¤ã‘ã¦ã¿ã‚‹  æ‹æ‰‹ãƒœã‚¿ãƒ³ã«ã¯Applause Buttonã‚’åˆ©ç”¨   ã¾ãšæ‹æ‰‹ãƒœã‚¿ãƒ³ã‚’ä½¿ã†ãŸã‚ã®CSSã¨JSã‚’èª­ã¿è¾¼ã¿  \u0026lt;head\u0026gt; ... {{ if .Site.Params.enableApplause }} \u0026lt;link href=\u0026#34;https://unpkg.com/applause-button/dist/applause-button.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/applause-button/dist/applause-button.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; {{ end }} \u0026lt;/head\u0026gt;  æ¬¡ã«ï¼Œæ‹æ‰‹ãƒœã‚¿ãƒ³ã‚’è¨­ç½®ã™ã‚‹éƒ¨å“ã‚’ä¸‹è¨˜ã®é€šã‚Šä½œæˆ  urlå±æ€§ã«å„è¨˜äº‹ãƒšãƒ¼ã‚¸ã®URL(Permlink)ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ï¼Œè¨˜äº‹ã”ã¨ã«æ‹æ‰‹æ•°ã‚’ä¿æŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹    {{ if .Site.Params.enableApplause }} \u0026lt;div\u0026gt; \u0026lt;applause-button color=\u0026#34;{{ .Site.Params.applauseButtonColor }}\u0026#34; url=\u0026#34;{{ .Permalink }}\u0026#34; multiclap=\u0026#34;true\u0026#34; style=\u0026#34;width: 55px; height: 55px; margin-right: 15px;\u0026#34;/\u0026gt; \u0026lt;/div\u0026gt; {{ end }}  ãã®å¾Œä¸Šè¨˜éƒ¨å“ã‚’å„è¨˜äº‹ã«è¡¨ç¤ºã™ã‚‹ã‚ˆã†è¨­å®š  ... \u0026lt;article class=\u0026#34;post\u0026#34;\u0026gt; {{ .Render \u0026#34;header\u0026#34; }} \u0026lt;div id=\u0026#34;socnet-share\u0026#34;\u0026gt; {{ partial \u0026#34;applause\u0026#34; . }} \u0026lt;!-- Add this line --\u0026gt; {{ partial \u0026#34;share-buttons\u0026#34; . }} \u0026lt;/div\u0026gt; ...  ãŸã ã—Applause Buttonã®CSSãŒãƒ–ãƒ­ã‚°ãƒ†ãƒ¼ãƒã®CSSã¨ç«¶åˆã—ã¦ã„ã‚‹ã®ã§ï¼Œä¸‹è¨˜ã‚’è¿½åŠ è¨­å®š  å…·ä½“çš„ã«ã¯ï¼Œã‚«ãƒ†ã‚´ãƒªã®è¨˜äº‹æ•°ã®è¦ç´ ã«ä¸ãˆã‚‰ã‚Œã‚‹.countã¨ï¼Œæ‹æ‰‹æ•°ã®è¦ç´ ã«ä¸ãˆã‚‰ã‚Œã‚‹.countãŒç«¶åˆã™ã‚‹ã®ã§ï¼Œæ‹æ‰‹æ•°ã®.count-container \u0026gt; .countã®CSSã«æ‰‹ã‚’åŠ ãˆã‚‹ ã¾ãŸapplause-buttonã®colorå±æ€§ã§æŒ‡å®šã—ãŸå€¤ã¯ï¼Œ.count-containerã®è¦ªè¦ç´ ã®.style-rootãŒæŒã£ã¦ã„ã‚‹ã®ã§ï¼Œãã“ã‹ã‚‰ç„¡ç†ã‚„ã‚Šç¶™æ‰¿ã™ã‚‹    .count-container { color: inherit !important; } .count-container \u0026gt; .count { float: none !important; color: inherit !important; } { \u0026#34;styles\u0026#34; : [ \u0026#34;css/applausebutton.css\u0026#34;, ...  ä¸Šè¨˜ãŒåæ˜ ã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’submoduleã«å…¥ã‚Œï¼Œãƒ–ãƒ­ã‚°æœ¬ä½“ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã™ã‚Œã°å„è¨˜äº‹ã«æ‹æ‰‹ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹  [params] ... enableApplause = true applauseButtonColor = \u0026#34;firebrick\u0026#34; ã‚¢ã‚¯ã‚»ã‚¹ã‚«ã‚¦ãƒ³ã‚¿  Hugo Future Imperfect Slimã§ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ï¼ŒQrunchã§ã‚‚ä½¿ã£ã¦ã„ãŸPixelaã‚°ãƒ©ãƒ•ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¿½åŠ  ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¿½è¨˜  iframeã‚¿ã‚°ã§ã‚‚æç”»å¯èƒ½ã ãŒï¼Œãƒ†ãƒ¼ãƒã®è‰²ã«åˆã‚ã›ã¦å¼·åˆ¶ã§ç™½èƒŒæ™¯ã«ã—ãŸã‹ã£ãŸã®ã§scriptã‚¿ã‚°ã‚’ä½¿ã£ã¦å®Ÿç¾    ... {{ if .Site.Params.sidebar.pixelaAccessCounter }} \u0026lt;section id=\u0026#34;pixela_access_counter\u0026#34;\u0026gt; \u0026lt;header\u0026gt; \u0026lt;h1\u0026gt;Blog PVs\u0026lt;/h1\u0026gt; \u0026lt;/header\u0026gt; \u0026lt;div id=\u0026#34;svg-load-area\u0026#34; style=\u0026#34;border: 1px solid rgba(161, 161, 161, 0.3);\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-align:right;\u0026#34;\u0026gt;Powered by \u0026lt;a href=\u0026#34;https://pixe.la/\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt;Pixela\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/section\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/tippy.js@3/dist/tippy.all.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; document.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, function(){ $(\u0026#39;#svg-load-area\u0026#39;).load(\u0026#39;{{.Site.Params.sidebar.pixelaACGraphURL}}\u0026#39;, function(){ tippy(\u0026#39;.each-day\u0026#39;, { arrow: true }); }); }); \u0026lt;/script\u0026gt; {{ end }} ...  ä¸Šè¨˜ãŒåæ˜ ã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’submoduleã«å…¥ã‚Œï¼Œãƒ–ãƒ­ã‚°æœ¬ä½“ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã™ã‚Œã°ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚‹  ... [params.sidebar] pixelaAccessCounter = true pixelaACGraphURL = \u0026#34;https://pixe.la/v1/users/\u0026lt;user-id\u0026gt;/graphs/\u0026lt;graph-id\u0026gt;?mode=short\u0026#34; ... Pixelaãƒ¦ãƒ¼ã‚¶ãƒšãƒ¼ã‚¸ã®socal icon  Hugo Future Imperfect Slimã§ã¯ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«Twitterãªã©ã®ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®ãƒªãƒ³ã‚¯ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¨­ç½®å¯èƒ½ æœ€è¿‘Pixelaã«ã¦ãƒ¦ãƒ¼ã‚¶ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã®ã§è‡ªåˆ†ã®ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ ã—ã¦ã¿ãŸ  Pixela ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ãŒã§ãã¾ã—ãŸï¼ï¼ˆv1.20.0 ãƒªãƒªãƒ¼ã‚¹ï¼‰ #pixela - ãˆã„ã®ã†ã«ã£ã   social iconè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä¸‹è¨˜ã‚’è¿½è¨˜  ... {{ with .Site.Social.pixela }}\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;//pixe.la/{{.}}\u0026#34; target=\u0026#34;_blank\u0026#34; rel=\u0026#34;noopener\u0026#34; title=\u0026#34;Pixela\u0026#34; class=\u0026#34;fas fa-th\u0026#34;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;{{ end }}  ä¸Šè¨˜ãŒåæ˜ ã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’submoduleã«å…¥ã‚Œï¼Œãƒ–ãƒ­ã‚°æœ¬ä½“ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã™ã‚Œã°ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹  [social] ... pixela = \u0026#34;@\u0026lt;pixela-user-id\u0026gt;\u0026#34; ","ref":"/blog/posts/2020_10_25/"},{"title":"bulmaã®columnã‚’ä½¿ã£ãŸéš›ã«ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºã™ã‚‹ã¨ã‚µã‚¤ãƒ‰ã«ä½™ç™½ãŒå‡ºã‚‹å ´åˆã®å¯¾å‡¦","date":"","description":"","body":"ç—‡çŠ¶  ä¸‹è¨˜ã®ç·‘é ˜åŸŸã®ã‚ˆã†ã«ï¼Œclassã«columnæŒ‡å®šã—ãŸè¦ç´ ã®paddingãŒï¼Œãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºã—ãŸéš›ã«ç”»é¢å¤–ã«è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†  è§£æ±º  ä¸‹è¨˜bodyã¸ã®cssè¨­å®šã‚’å…¥ã‚Œã‚‹  ... \u0026lt;style lang=\u0026#34;scss\u0026#34;\u0026gt; ... body { overflow-x: hidden; } ... \u0026lt;/style\u0026gt; å‚è€ƒ  ä¸‹è¨˜ã§è­°è«–ã•ã‚Œã¦ã‚‹  class \u0026ldquo;columns\u0026rdquo; too wide on mobile Â· Issue #449 Â· jgthms/bulma Â· GitHub    ","ref":"/blog/posts/2020_04_30/"},{"title":"ãƒªãƒ³ã‚°ãƒ•ã‚£ãƒƒãƒˆã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼ã®é‹å‹•ãƒ­ã‚°ã‚’ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§Pixelaã«è¨˜éŒ²ã™ã‚‹","date":"","description":"","body":"ä½œã£ãŸã‚‚ã®  ãƒªãƒ³ã‚°ãƒ•ã‚£ãƒƒãƒˆã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼ã®é‹å‹•ãƒ­ã‚°(æ´»å‹•æ™‚é–“ï¼Œæ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼ï¼Œèµ°è¡Œè·é›¢)ã‚’Pixelaã«è¨˜éŒ²ã—ã¦è‰åŒ–ã™ã‚‹æ©Ÿèƒ½ã‚’ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§é–‹ç™º Switchä¸Šã§ã‚¹ã‚¯ã‚·ãƒ§ã‚’æ’®ã‚ŠTwitteræŠ•ç¨¿ã™ã‚‹ã¨ï¼Œç”»åƒå–å¾—ãƒ»è§£æã—ã¦Pixelaã®ã‚°ãƒ©ãƒ•ã«è¨˜éŒ²  çµæœ  æœ€è¿‘ã®ã‚µãƒœã‚ŠãŒå¯è¦–åŒ–ã•ã‚ŒãŸğŸ’ª   ãƒˆãƒªã‚¬ã«ãªã‚‹ãƒ„ã‚¤ãƒ¼ãƒˆã¯â†“ãªæ„Ÿã˜  #ãƒªãƒ³ã‚°ãƒ•ã‚£ãƒƒãƒˆã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼ #RingFitAdventure #NintendoSwitch pic.twitter.com/ZnoWCO30No\n\u0026mdash; JagiJagiJagi (@jagijagijag1) January 25, 2020 \råˆ¶ç´„  ä¸‹è¨˜ç”»åƒã®ã‚ˆã†ãªæ—¥æ¯ã®é‹å‹•ãƒ­ã‚°ç”»é¢ã‹ã‚‰æ´»å‹•æ™‚é–“ï¼Œæ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼, èµ°è¡Œè·é›¢ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã®ã¿ãŒå¯¾è±¡  ãã®ä»–ç”»é¢ã®ã‚¹ã‚¯ã‚·ãƒ§ã‚„å€‹åˆ¥é‹å‹•ãƒ­ã‚°ã¯å¯¾è±¡å¤–    Twitterã®ãƒ„ã‚¤ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã®HTMLã‚’è§£æã™ã‚‹ãŸã‚ï¼Œãƒšãƒ¼ã‚¸ã®ä»•æ§˜ãŒå¤‰ã‚ã‚‹ã¨å®Ÿè¡Œä¸å¯ ã¾ã‚Œã«AWS RekognitionãŒ0ã‚’oã¨åˆ¤å®šã—ï¼ŒPixelaã¸ã®è¨˜éŒ²æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ (æ•°å€¤ã—ã‹ã‚ã‚Šãˆãªã„ã®ã§ç„¡ç†ã‚„ã‚Šè£œæ­£ã§ããªãã‚‚ãªã„ãŒæœªå®Ÿæ–½)  å…¨ä½“æ–¹é‡  ãƒªãƒ³ã‚°ãƒ•ã‚£ãƒƒãƒˆã®è¨˜éŒ²ã¯APIã§å–å¾—ã—ãŸã‚Šã¯ã§ããªã„ã®ã§ï¼Œã‚¹ã‚¯ã‚·ãƒ§ã‹ã‚‰æƒ…å ±å¼•ã£ã“æŠœãã—ã‹ãªã„(ã¨æ€ã‚ã‚Œã‚‹) é ‘å¼µã‚Šåº¦ã¨ç¶™ç¶šåº¦ãŒã¿ãŸã„ã®ã§ï¼Œãƒ©ã‚¤ãƒ•ãƒ­ã‚°ã‚’è‰²ã€…è¨˜éŒ²ã—ã¦ã„ã‚‹Pixelaã§å¯è¦–åŒ–  Switchã‚¹ã‚¯ã‚·ãƒ§å–å¾—æ–¹é‡  Switchã®ã‚¹ã‚¯ã‚·ãƒ§ã‚’è‡ªå‹•ã§ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«æŒã£ã¦ã„ãæ‰‹æ®µãŒãªã„  SDã‚«ãƒ¼ãƒ‰ã‚’çµŒç”±ã™ã‚‹æ–¹æ³•ã ã¨ãƒãƒƒãƒçš„ã«ãªã‚‹ \u0026amp; æ€ æƒ°ãªã®ã§ç¶šã‹ãªãã†â€¦   Swithcã§ã‚¹ã‚¯ã‚·ãƒ§æŠ•ç¨¿ã¯ã§ãã‚‹ã®ã§ï¼ŒTwitterã«ã‚ã’ã¦ãã“ã‹ã‚‰è‡ªå‹•ã§ã”ã«ã‚‡ã”ã«ã‚‡ã™ã‚‹æ–¹é‡ã« â†’ ã‚µãƒ¼ãƒ“ã‚¹é€£æºã¨ã—ã¦æ‰‹è»½ãªIFTTTã‚’ä½¿ã£ã¦ç‰¹å®šã®ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ä»˜ãTwitteræŠ•ç¨¿ã‚’è‡ªå‹•å–å¾— -\u0026gt; å¾Œç¶šå‡¦ç†ã®APIã‚’å©ããƒ¬ã‚·ãƒ”ã¯å¾Œè¿°  ã‚¹ã‚¯ã‚·ãƒ§ã‹ã‚‰ã®æƒ…å ±æŠ½å‡º   Garminã‚¹ãƒˆãƒ¬ã‚¹ã®ã¨ãã¯AWS Rekognitionã‚’ä½¿ã£ãŸãŒï¼Œæ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆæ¤œå‡ºæœªå¯¾å¿œ\n cf. Garmin connectã®ã‚¹ãƒˆãƒ¬ã‚¹æ¸¬å®šçµæœã‚’Pixela + Serverlessã§è‰åŒ– - jagijagijag1\u0026rsquo;s tech blog    ãã®ãŸã‚Google Cloudã®Vision APIã‚’åˆ©ç”¨ã™ã‚‹æ–¹é‡ã§æ¤œè¨ï¼Œãƒ‡ãƒ¢è©¦ã—ã¦è¡Œã‘ãã†\n   ã¨æ€ã£ãŸãŒï¼Œæ—¥ä»˜ã¨æ´»å‹•é‡ã®æ•°å€¤ã ã‘å–ã‚‹ãªã‚‰Rekognitionã§ã‚‚ã§ããã†ãªã®ã§ï¼Œæ…£ã‚Œã¦ã„ã‚‹AWSã‚’ä½¿ã†æ–¹é‡ã«ï¼Œã“ã£ã¡ã§ã‚‚è¡Œã‘ãã† (â†“ã ã‘è¦‹ã‚‹ã¨æ—¥æœ¬èªã‚‚å–ã‚Œã¦ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã‘ã©æ—¥æœ¬èªéƒ¨åˆ†ã¯è‹±æ•°å­—ã®ç¾…åˆ—ã¨ã—ã¦çµæœãŒè¿”ã£ã¦ãã‚‹)\n\r  ãã®ä»–ã¤ã¾ã¥ããªã©  IFTTTã§å–å¾—ã§ãã‚‹ãƒªãƒ³ã‚¯ã¯ç”»åƒè‡ªä½“ã®ãƒªãƒ³ã‚¯ã§ãªãç”»åƒãƒ„ã‚¤ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã®ãƒªãƒ³ã‚¯ãªã®ã§ï¼ŒIFTTTã‹ã‚‰API(Lambda)ã«æ¸¡ã•ã‚Œã‚‹ãƒªãƒ³ã‚¯ã‹ã‚‰ç”»åƒãƒªãƒ³ã‚¯ã‚’æ¢ã—å‡ºã™ã¯ã‚ã«â€¦  Integromatã ã¨ãƒ„ã‚¤ãƒ¼ãƒˆã®ç”»åƒãƒªãƒ³ã‚¯å–å¾—ã¾ã§ã§ãã‚‹ã£ã½ã„   æ—¥ä»˜ã«ã¤ã„ã¦ï¼Œã‚¹ã‚¯ã‚·ãƒ§ã‹ã‚‰ã¯æœˆã¨æ—¥(mm/dd)ã—ã‹å–ã‚Œãªã„ãŸã‚ï¼Œã¨ã‚Šã‚ãˆãšå‡¦ç†å®Ÿè¡Œæ™‚ã®å¹´ã‚’ä»˜ä¸ã—ï¼Œãã‚ŒãŒæœªæ¥ã®æ—¥ä»˜ã®å ´åˆã¯å¹´ã‚’1å¹´å‰ã®æ—¥ä»˜ã§è¨˜éŒ²ã™ã‚‹ã‚ˆã†å®Ÿè£…  e.g. 01/23 -\u0026gt; 20200123, 10/23 -\u0026gt; 20191023 (20201023ã¯æœªæ¥ãªã®ã§)   ãƒ„ã‚¤ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰ç”»åƒURLã‚’å¼•ã£ã“æŠœãå®Ÿè£…ã«ã—ãŸã“ã¨ã«ã‚ˆã‚Šï¼Œè¤‡æ•°ç”»åƒã®ã¾ã¨ã‚ã¦æŠ•ç¨¿ã«ã‚‚å¯¾å¿œå¯èƒ½ã«  ãŸã ã—ç”»åƒãŒå¤šã„ã¨IFTTTã®Webhookã®å¾…ã¡æ™‚é–“ã‚’è¶…éã™ã‚‹ã£ã½ãï¼ŒIFTTTä¸Šã¯å¤±æ•—æ‰±ã„ã« (Lambdaã¯æ­£å¸¸çµ‚äº†ã—Pixelaã«ã‚‚è¨˜éŒ²ã•ã‚Œã‚‹)    å®Ÿè£…å†…å®¹  ã‚³ãƒ¼ãƒ‰ã¯â†’jagijagijag1/ringfit2pixela Â· GitHub  ç’°å¢ƒ  Go 1.13.6 Serverless Framework 1.61.3  Lambda function (ç”»åƒå–å¾—ãƒ»æƒ…å ±æŠ½å‡ºãƒ»ã‚°ãƒ©ãƒ•è¨˜éŒ²)  IFTTTã®ãƒ¬ã‚·ãƒ”ä½œæˆæ™‚ã«ï¼ŒLambdaé–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹API Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLãŒå¿…è¦ã«ãªã‚‹ãŸã‚å…ˆã«ã“ã¡ã‚‰å´ã‚’å®Ÿè£… Serverless Frameworkã‚’ç”¨ã„ã¦Goã§å®Ÿè£…ã—ãŸLambdaé–¢æ•° + API Gatewayã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ è©³ç´°ã¯ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼Œæ¦‚è¦ã¯ä»¥ä¸‹  IFTTTã‹ã‚‰é€ã‚‰ã‚Œã¦ããŸãƒ„ã‚¤ãƒ¼ãƒˆã®URLã‚’å…¥åŠ›ã«ï¼Œç”»åƒURLã‚’å¼•ã£ã“æŠœãï¼ŒRekognitionã§ã®ãƒ†ã‚­ã‚¹ãƒˆæ¤œçŸ¥çµæœã‚’å—ã‘ï¼ŒPixelaã«è¨˜éŒ²ã™ã‚‹  å…¥åŠ›ã®URLã‚’HTMLè§£æã—ã¦ç”»åƒURLã‚’æŠ½å‡ºã—ï¼Œç”»åƒURLã‹ã‚‰ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ï¼ŒRekognitionã«ã‚ãŸã™ è¨˜éŒ²ã—ãŸã„æƒ…å ±ã¯ï¼Œãã®æƒ…å ±ãŒã‚ã‚‹ã§ã‚ã‚ã†åº§æ¨™ã‚’ã‚ã‚‰ã‹ã˜ã‚ä¸ãˆã¦ãŠãï¼ŒRekognitionã®çµæœã®ã†ã¡æƒ³å®šåº§æ¨™ã«å¯¾ã—ã¦æœ€è¿‘å‚ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆ©ç”¨      IFTTT: Twitter â†’ Webhook (API Gateway)  IFTTã§ä¸‹è¨˜ãƒ¬ã‚·ãƒ”ã§ä½œæˆã™ã‚‹  ã“ã“ã§ã¯ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚° #RingFitAdventureã®ã‚ã‚‹ãƒ„ã‚¤ãƒ¼ãƒˆã‚’å¯¾è±¡ã« (ä»»æ„ã®ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã§OK) URLæ¬„ã«ã¯ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸAPI Gatewayã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ(=make deployã—ãŸéš›ã®å‡ºåŠ›ã®ServiceEndpoint)ã«/ringfit2pixelaãªã©ã®ãƒ‘ã‚¹ã‚’ãã£ã¤ã‘ãŸURLã‚’è¨­å®š   ä¸‹è¨˜ãƒ¬ã‚·ãƒ”ä½œæˆå¾Œï¼ŒNintendo Switchå†…ã§TwitteræŠ•ç¨¿ã™ã‚Œã°Pixelaã«è¨˜éŒ²ã•ã‚Œã‚‹ã¯ãš  ãŸã ã—IFTTTã®å®Ÿè¡ŒãŒçµæ§‹é…ã„ (10ã€œ20åˆ†ãã‚‰ã„ã‹ã‹ã‚‹)    \n","ref":"/blog/posts/2020_01_26/"},{"title":"Cloue Run + Puppeteer + Cloud Schedulebr ã§ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãªã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å®šæœŸå®Ÿè¡Œã™ã‚‹","date":"","description":"","body":"ã¤ãã‚‹ã‚‚ã®  æ‰‹è»½ã«å®šæœŸå®Ÿè¡Œã™ã‚‹ã‚¯ãƒ­ãƒ¼ãƒ©ã‚’ä½œã‚ŠãŸã‹ã£ãŸ é¡Œæã¨ã—ã¦ï¼Œã‚ã™ã‘ã‚“ ã®ã‚¹ã‚³ã‚¢(å¥åº·åº¦)ã‚’Pixelaã«è»¢è¨˜ã™ã‚‹å‡¦ç†ã‚’1æ—¥1å›å®Ÿè¡Œã™ã‚‹è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’ã¤ãã‚‹  è»¢è¨˜ã®çµæœ ã¤ã¾ã¥ããƒ¡ãƒ¢ AWS Lambdaã‚’ã‚„ã‚ã¦GCP Cloud Runã‚’é¸æŠ  ã¾ãšæœ€åˆã«ï¼Œãƒ­ãƒ¼ã‚«ãƒ«ã§Puppeteerã‚’ç”¨ã„ã¦askenã‚’crawl â†’ pixelaã¸è¨˜éŒ²ã™ã‚‹æ©Ÿèƒ½ã‚’é–‹ç™º  asken2pixela/local GitHub   ã“ã‚Œã‚’ãƒ™ãƒ¼ã‚¹ã«Puppeterr on Lambdaã§ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãªå®šæœŸã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å®Ÿç¾ã™ã‚‹ã¤ã‚‚ã‚Šã ã£ãŸ  ref: Puppeteer on AWS Lambdaã‚’Typescriptã‹ã‚‰ã‚µã‚¯ãƒƒã¨ä½¿ã†(2019å¹´9æœˆç‰ˆ) - ADliveãƒ†ãƒƒã‚¯ãƒ–ãƒ­ã‚°   ãŒï¼ŒPage.$$eval()ã®è¿”ã‚Šå€¤ãŒé€šå¸¸ã®Puppeteerã¨Lambdaç”¨ã®Puppeteerã¨ã§é•ã£ãŸâ€¦  é€šå¸¸ã®Puppeteer: Array\u0026lt;Element\u0026gt;ãŒè¿”ã£ã¦ããŸ Lambdaç”¨ã®Puppeteer: Array\u0026lt;ElementHandle\u0026gt;ãŒè¿”ã£ã¦ããŸ   ã“ã®ã‚®ãƒ£ãƒƒãƒ—ã‚’åŸ‹ã‚ã‚‹ä¿®æ­£ãŒé¢å€’ãªã®ã§ï¼Œãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã„ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰(=æ™®é€šã®Puppeteer)ã‚’ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§å‹•ã‹ã›ã°ã„ã„ã®ã§ã¯? â†’ Cloud RunãŒã‚ã‚‹ï¼  Cloud Run: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œã˜ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ãƒ»å‡¦ç†ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãªGCPã®ã‚µãƒ¼ãƒ“ã‚¹    Puppeteerã®evalãªã©ã§æ¸¡ã™é–¢æ•°å†…å‡¦ç†ã®ãƒ­ã‚®ãƒ³ã‚°  Puppeteerã®Page.$$eval()ãªã©ã®å¼•æ•°ã§æ¸¡ã™é–¢æ•°å†…ã§console.log()ã§ãƒ­ã‚°ã‚’å–ã‚ŠãŸã‹ã£ãŸãŒï¼Œãã®ã¾ã¾æ›¸ã„ã¦ã‚‚ã‚¹ã‚³ãƒ¼ãƒ—ãŒå¤‰ã‚ã‚‹ãŸã‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã•ã‚Œãªã„ ã“ã‚Œã«å¯¾ã—ï¼Œconsleã‚¤ãƒ™ãƒ³ãƒˆã‚’dispatchã™ã‚‹ã“ã¨ãŒã§ããŸãŸã‚ï¼ŒPageã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ä¸‹è¨˜å‡¦ç†ã‚’å®Ÿæ–½ã—ï¼ŒPage.$$eval()å†…ã®ãƒ­ã‚°å‡ºåŠ›ã«æˆåŠŸ  ref: javascript - Puppeteer log inside page.evaluate - Stack Overflow    const browser = await puppeteer.launch(); const page = await browser.newPage(); page.on(\u0026#39;console\u0026#39;, consoleMessageObject =\u0026gt; function (consoleMessageObject) { if (consoleMessageObject.type() !== \u0026#39;warning\u0026#39;) { console.debug(consoleMessageObject.text()) } }); await page.goto(\u0026#39;https://google.com\u0026#39;); const result = await page.evaluate(() =\u0026gt; { console.log(\u0026#39;Browser scope.\u0026#39;); return \u0026#39;Normal scope.\u0026#39;; }); console.log(result) ãã®ä»–ç´°ã‹ã„ã¨ã“ã‚  Dockerfileã§AZã‚’æŒ‡å®šã—ãªã„ã¨æ—¥ä»˜ãŒUTCã§å‡¦ç†ã•ã‚Œã‚‹  Cloud SchedulerãŒJST 11/23 1:00ã«èµ·å‹•ã—ã¦ã‚‚ï¼ŒUTC 11/22 16:00ã§å‡¦ç†ãŒé€²ã‚€   TypeScriptã‚¢ãƒ—ãƒªã‚’Dockerã«ä¹—ã›ã‚‹ã¨ãã®ä½œæ³•ã‚’çŸ¥ã‚‰ãªã„â€¦  ã¨ã‚Šã‚ãˆãšä»Šå›ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã—ã¦ï¼Œç”Ÿæˆã•ã‚ŒãŸindex.jsã ã‘ã‚’Dockerã«ã®ã›ãŸ    é–‹ç™ºç’°å¢ƒ GCPã‚¢ã‚«ã‚¦ãƒ³ãƒˆ/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä½œæˆæ¸ˆã¿ã¨ã™ã‚‹ï¼\n$ gcloud version Google Cloud SDK 271.0.0 beta 2019.05.17 bq 2.0.50 core 2019.11.08 gsutil 4.46 $ yarn --version 1.19.1 $ tsc --version Version 3.6.4 é–‹ç™ºè©³ç´°  ä½œã£ãŸã‚‚ã®ã¯GitHub - jagijagijag1/asken2pixela  1. Puppeteer on Cloud Runã®å‹•ä½œç¢ºèª Expressã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã¦Puppeteerã‚’å®Ÿè¡Œã™ã‚‹è¨­å®šãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æº–å‚™  package.json  { \u0026#34;name\u0026#34;: \u0026#34;asken2pixela-cloudrun\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;asken2pixela on GCP Cloud Run\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;index.js\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;start\u0026#34;: \u0026#34;tsc -p . \u0026amp;\u0026amp; node .\u0026#34;, \u0026#34;build\u0026#34;: \u0026#34;tsc -p .\u0026#34;, \u0026#34;server\u0026#34;: \u0026#34;node index.js\u0026#34; }, \u0026#34;author\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;, \u0026#34;dependencies\u0026#34;: { \u0026#34;express\u0026#34;: \u0026#34;^4.17.1\u0026#34;, \u0026#34;puppeteer\u0026#34;: \u0026#34;^2.0.0\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;@types/express\u0026#34;: \u0026#34;^4.17.2\u0026#34;, \u0026#34;@types/puppeteer\u0026#34;: \u0026#34;^1.20.2\u0026#34;, \u0026#34;typescript\u0026#34;: \u0026#34;^3.7.2\u0026#34; } }  index.ts  import puppeteer from \u0026#39;puppeteer\u0026#39; import express from \u0026#34;express\u0026#34;; const app = express(); const askenUrl = \u0026#39;http://asken.jp/login\u0026#39;; // put your own target  app.get(\u0026#39;/\u0026#39;, async (req, res) =\u0026gt; { console.log(\u0026#39;Request received\u0026#39;); const browser = await puppeteer.launch(); const page = await browser.newPage(); await page.goto(askenUrl); const title = await page.title(); await page.close(); // response message with web page title  res.send(`Access to ${title}`); }); const port = process.env.PORT || 8080; app.listen(port, () =\u0026gt; { console.log(\u0026#39;Listening on port\u0026#39;, port); });  Dockerfile  # Use the official lightweight Node.js 10 image.\r# https://hub.docker.com/_/node\rFROM node:10-slim\r# Create and change to the app directory.\rWORKDIR /usr/src/app\r# Copy application dependency manifests to the container image.\rCOPY package.json yarn.lock ./\r# Install latest chrome dev package and fonts to support major charsets (Chinese, Japanese, Arabic, Hebrew, Thai and a few others)\rRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \\\r\u0026amp;\u0026amp; sh -c 'echo \u0026quot;deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main\u0026quot; \u0026gt;\u0026gt; /etc/apt/sources.list.d/google.list' \\\r\u0026amp;\u0026amp; apt-get update \\\r\u0026amp;\u0026amp; apt-get install -y google-chrome-unstable fonts-ipafont-gothic fonts-wqy-zenhei fonts-thai-tlwg fonts-kacst fonts-freefont-ttf \\\r--no-install-recommends \\\r\u0026amp;\u0026amp; rm -rf /var/lib/apt/lists/*\r# Install puppeteer so it's available in the container.\rRUN yarn add puppeteer \\\r# Add user so we don't need --no-sandbox.\r# same layer as npm install to keep re-chowned files from using up several hundred MBs more space\r\u0026amp;\u0026amp; groupadd -r pptruser \u0026amp;\u0026amp; useradd -r -g pptruser -G audio,video pptruser \\\r\u0026amp;\u0026amp; mkdir -p /home/pptruser/Downloads \\\r\u0026amp;\u0026amp; chown -R pptruser:pptruser /home/pptruser \\\r\u0026amp;\u0026amp; chown -R pptruser:pptruser ./node_modules\r# Set environment variables\rENV TZ Asia/Tokyo\rENV PORT 8080\r# Install production dependencies.\rRUN yarn install --production\r# Copy local code to the container image.\rCOPY index.js ./\rRUN chown -R pptruser:pptruser ./*\r# Run everything after as non-privileged user.\rUSER pptruser\r# Run the web service on container startup.\rEXPOSE 8080\rCMD [ \u0026quot;yarn\u0026quot;, \u0026quot;run\u0026quot;, \u0026quot;server\u0026quot; ]\r Dockerã§Puppeteerã‚’å‹•ã‹ã™ã¨ãã®å‚è€ƒ: puppeteer/troubleshooting.md at master GoogleChrome/puppeteer GitHub  ç”¨æ„ã—ãŸã‚‚ã®ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ $ yarn install # build TypeScript code $ yarn build # push Dockerfile to GCP $ gcloud builds submit --tag gcr.io/\u0026lt;your-projectr-id\u0026gt;/\u0026lt;your-image-name\u0026gt; # create Cloud Run (Puppeteerã‚’å‹•ã‹ã™ãŸã‚ï¼Œãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºã‚’512Mã«è¨­å®š) $ cloud beta run deploy \u0026lt;your-cloudrun-name\u0026gt; --image gcr.io//\u0026lt;your-projectr-id\u0026gt;/\u0026lt;your-image-name\u0026gt; --platform managed --region asia-northeast1 --allow-unauthenticated --memory 512Mi  æœ€å¾Œã«Cloud Runã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ãƒ¡ãƒ¢ã—ã¦ãŠã  å½“è©²URLã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ã‚¯ã‚»ã‚¹ or curlã§å‹•ä½œç¢ºèªå¯èƒ½    2. Cloud Schedulerã®ä½œæˆãƒ»å‹•ä½œç¢ºèª æ¯æ—¥AM1:00ã«ä¸Šè¨˜Cloud Runã‚’å®Ÿè¡Œã™ã‚‹Cloud Schedulerã‚¸ãƒ§ãƒ–ã‚’ä½œæˆã—ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ # create Cloud Scheduler job $ gcloud scheduler jobs create http \u0026lt;your-job-name\u0026gt; --schedule \u0026#34;00 01 * * *\u0026#34; --time-zone \u0026#34;Asia/Tokyo\u0026#34; --http-method=GET --uri=\u0026#34;\u0026lt;your-cloudrun-endpoint\u0026gt;\u0026#34; --headers=Content-Type=application/json # test run $ gcloud scheduler jobs run \u0026lt;your-job-name\u0026gt;  ãã®å¾ŒCloud Run, Cloud Schedulerã®ãƒ­ã‚°ã‚’ç¢ºèªã—å‹•ä½œç¢ºèª  3. Puppeteerå‡¦ç†ã®å®Ÿè£… åˆ©ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ  $ yarn add axios ãƒ¡ã‚¤ãƒ³å‡¦ç† é•·ã„ã®ã§ä¸‹è¨˜å‚ç…§ (puppeterã§crawlã—ã¦å–å¾—ã—ãŸçµæœã‚’axiosã§postã—ã¦ã‚‹ã ã‘) asken2pixela/index.ts GitHub\nDockerfileã«ç’°å¢ƒå¤‰æ•°è¨­å®šã‚’è¿½åŠ  ...\r# Set environment variables\rENV TZ Asia/Tokyo\rENV PORT 8080\rENV ASKEN_URL http://asken.jp/login\rENV ASKEN_EMAIL \u0026lt;your-login-email-address\rENV ASKEN_PASS \u0026lt;your-login-password\u0026gt;\rENV PIXELA_USER \u0026lt;your-pixela-user-id\rENV PIXELA__GRAPH \u0026lt;your-pixela-graph-id\rENV PIXELA_TOKEN \u0026lt;your-pixela-token\u0026gt;\r...\rå†ãƒ‡ãƒ—ãƒ­ã‚¤ # build \u0026amp; push Dockerfile to GCP $ yarn build \u0026amp;\u0026amp; gcloud builds submit --tag gcr.io/\u0026lt;your-projectr-id\u0026gt;/\u0026lt;your-image-name\u0026gt; # create Cloud Run (Puppeteerã‚’å‹•ã‹ã™ãŸã‚ï¼Œãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºã‚’512Mã«è¨­å®š) $ cloud beta run deploy \u0026lt;your-cloudrun-name\u0026gt; --image gcr.io//\u0026lt;your-projectr-id\u0026gt;/\u0026lt;your-image-name\u0026gt; --platform managed --region asia-northeast1 --allow-unauthenticated --memory 512Mi å®Œæˆï¼\n","ref":"/blog/posts/2019_11_23/"},{"title":"Boostnoteã®å‹•ä½œãŒé‡ã„ã¨ãã®ä¸€è§£æ±ºäº‹ä¾‹","date":"","description":"","body":"çµè«–  \u0026ldquo;Preference\u0026rdquo; â†’ \u0026ldquo;Boostnoteã«ã¤ã„ã¦\u0026rdquo; â†’ \u0026ldquo;è§£æ\u0026quot;ã§Boostnote ã®æ©Ÿèƒ½å‘ä¸Šã®ãŸã‚ã®è§£ææ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã‚’ã‚ªãƒ•ã«ã™ã‚‹ã¨è§£æ±ºã™ã‚‹ã‹ã‚‚  ç—‡çŠ¶  Boostnoteä¸Šã§é »ç¹ã«ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ãƒ»æ–‡å­—å…¥åŠ›ãªã©ã®å‹•ä½œãŒé‡ããªã‚‹ (ã‚­ãƒ¼å…¥åŠ›ã®åæ˜ ãŒé…å»¶ã™ã‚‹) CPUä½¿ç”¨ç‡ã‚’è¦‹ã¦ã¿ã‚‹ã¨ï¼Œä¸å®šæœŸã«Boostnoteã®CPUä½¿ç”¨ç‡ãŒç•°å¸¸ä¸Šæ˜‡ã—ã¦ã„ãŸ  åŸå› èª¿æŸ»  Developer Toolã‚’é–‹ãã¨ï¼ŒAWS Cognitoã¸ã®POSTãƒ¡ã‚½ãƒƒãƒ‰ã®å¤±æ•—ãŒå¤§é‡ã«ã‚ã‚‰ã‚ã‚Œã¦ã„ãŸ èª¿ã¹ã‚‹ã¨â†“ã¨ã»ã¼åŒæ§˜ã®ç—‡çŠ¶ã ãŒï¼Œã“ã“ã§ã¯å‡¦ç†ãŒé‡ã„ã¨ã„ã†è¨€åŠã‚‚ãªã—  Amazon Cognito Indentity status 400 Issue #1905 BoostIO/Boostnote GitHub     Cognitoã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ä½¿ç”¨çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆã®åé›†ã®ãŸã‚ã®ã‚ˆã†ã§ï¼Œä¸Šè¨˜Issueã§ã¯ç„¡è¦–ã™ã‚‹ã‹ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’ã‚ªãƒ•ã«ã™ã‚‹ã‹ã¨ã®ã“ã¨ è‡ªåˆ†ã®ã‚±ãƒ¼ã‚¹ã§ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãŒç„¡ã„çŠ¶æ³ã§Boostnoteã‚’ä½¿ã£ãŸã¨ãã«ã“ã®ç—‡çŠ¶ãŒç™ºç”Ÿã—ã¦ã„ãŸ  è§£æ±º  å®Ÿéš›ã«\u0026quot;Preference\u0026rdquo; â†’ \u0026ldquo;Boostnoteã«ã¤ã„ã¦\u0026rdquo; â†’ \u0026ldquo;è§£æ\u0026quot;ã§Boostnote ã®æ©Ÿèƒ½å‘ä¸Šã®ãŸã‚ã®è§£ææ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã‚’ã‚ªãƒ•ã«ã—ã¦ã¿ãŸã¨ã“ã‚ï¼Œå‹•ä½œãŒé‡ããªã‚‹äº‹è±¡ãŒãªããªã‚Šï¼ŒCPUä½¿ç”¨ç‡ã‚‚ä¸ŠãŒã‚‰ãªããªã£ãŸ  ","ref":"/blog/posts/2019_10_05/"},{"title":"Qrunchãƒ–ãƒ­ã‚°ã®ã‚µã‚¤ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«Pixelaã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤ºã™ã‚‹","date":"","description":"","body":" å…ˆæ—¥Qrunchã®å¤§å¹…ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã‚ˆã‚Šï¼Œãƒ–ãƒ­ã‚°ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ãŒä¸ŠãŒã£ãŸ  ä»»æ„ã®HTMLãƒ»JSã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæŒ¿å…¥å¯èƒ½ã«    ã€ãŠçŸ¥ã‚‰ã›ã€‘æ­£å¼ãƒªãƒªãƒ¼ã‚¹å‰æœ€å¾Œã®å¤§å¹…ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’è¡Œã„ã¾ã™ï¼ï¼ˆ8æœˆä¸‹æ—¬äºˆå®šï¼‰\n ã¨ã„ã†ã“ã¨ã§ï¼Œâ†“ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã¯ã¦ãªãƒ–ãƒ­ã‚°ã¸ã®Pixelaã‚°ãƒ©ãƒ•åŸ‹ã‚è¾¼ã¿ã‚’Qrunchã§ã‚‚ã§ãã‚‹ã¯ãš!  ã¯ã¦ãªãƒ–ãƒ­ã‚°ã« Pixela ã‚°ãƒ©ãƒ•ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã€ã•ã‚‰ã«ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºã•ã›ã‚‹æ–¹æ³•\nå®Œæˆå›³  è¡¨ç¤ºã”ã¨ã«incrementã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã§ç°¡æ˜“PVã« éå»ã«ä½œã£ãŸã‚¹ãƒˆãƒ¬ã‚¹è‰åŒ–ã§ï¼Œã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã¤ã¤ã‚‚ç”Ÿå­˜ã—ã¦ã‚‹å ±å‘Š  æ‰‹é †  a-knowã•ã‚“ã®ãƒ–ãƒ­ã‚°è¦‹ã‚Œã°å•é¡Œãªã„ã‘ã©ï¼Œä¸€å¿œQrunchã®UIä¸Šã§ã©ã“ã‚’è¨­å®šã™ã‚‹ã‹ãƒ¡ãƒ¢ (æŒ‡å®šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚‚å…ƒè¨˜äº‹ã®ã¾ã¾) ä»¥ä¸‹ï¼Œ[ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼]â†’[ãƒ‡ã‚¶ã‚¤ãƒ³ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º] or ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å†…[ãƒ‡ã‚¶ã‚¤ãƒ³]ã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒ–ãƒ­ã‚°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®šç”»é¢ã§ä½œæ¥­  ã‚µã‚¤ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ  (ã‚°ãƒ©ãƒ•è¡¨ç¤ºé ˜åŸŸè¨­å®š)  [ã‚µã‚¤ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«]ã«ã¦[ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¿½åŠ ã™ã‚‹] [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—]ã§[ã‚«ã‚¹ã‚¿ãƒ ]ã‚’é¸æŠ [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¤ãƒˆãƒ«]ã¯ä»»æ„ï¼Œ[ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆã‚«ã‚¹ã‚¿ãƒ HTMLï¼‰]ã«ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰(a-knowã•ã‚“ãƒ–ãƒ­ã‚°ã¾ã¾)ã‚’å…¥åŠ›ã—ï¼Œ[è¿½åŠ ã™ã‚‹]  \u0026lt;div id=\u0026#34;svg-load-area\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div style=\u0026#34;text-align:right;\u0026#34;\u0026gt;Powered by \u0026lt;a href=\u0026#34;https://pixe.la/\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt;Pixela\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt; ãƒ˜ãƒƒãƒ€ä¸‹ or ãƒ•ãƒƒã‚¿ä¸Šã«scriptã‚¿ã‚°è¿½åŠ  (è¡¨ç¤ºã™ã‚‹ã‚°ãƒ©ãƒ•ã®è¨­å®š)  [ã‚«ã‚¹ã‚¿ãƒ HTML]ã«ã¦[ãƒ˜ãƒƒãƒ€ãƒ¼ä¸‹] or [ãƒ•ãƒƒã‚¿ãƒ¼ä¸Š]ã‚’é¸æŠ  ãƒ˜ãƒƒãƒ€ä¸‹ or ãƒ•ãƒƒã‚¿ä¸Šã¸ã®ã‚³ãƒ¼ãƒ‰æŒ‡å®šã¯PROæ©Ÿèƒ½ã ãŒï¼Œä»Šã®æ‰€ãƒ™ãƒ¼ã‚¿æœŸé–“ã§èª°ã§ã‚‚ç„¡æ–™ã§PROæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã§ãã‚‹  https://qrunch.net/pro     è¡¨ç¤ºã•ã‚ŒãŸå…¥åŠ›ã‚¨ãƒªã‚¢ã«ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰(a-knowã•ã‚“ãƒ–ãƒ­ã‚°ã¾ã¾)ã‚’å…¥åŠ›ã—ï¼Œ[é©ç”¨] (ã‚°ãƒ©ãƒ•URLã¯è¡¨ç¤ºã—ãŸã„ã‚°ãƒ©ãƒ•ã‚’æŒ‡å®š)  \u0026lt;script src=\u0026#34;https://unpkg.com/tippy.js@3/dist/tippy.all.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; document.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, function(){ $(\u0026#39;#svg-load-area\u0026#39;).load(\u0026#39;https://pixe.la/v1/users/a-know-blog/graphs/page-views?mode=short\u0026#39;, function(){ tippy(\u0026#39;.each-day\u0026#39;, { arrow: true }); }); }); \u0026lt;/script\u0026gt; ","ref":"/blog/posts/2019_09_03/"},{"title":"ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§å®šæœŸçš„ã«Dropboxå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ã«è»¢é€ã™ã‚‹","date":"","description":"","body":"ã¤ãã£ãŸã‚‚ã®  å®šæœŸå®Ÿè¡Œã§Dropboxã®ç‰¹å®šãƒ•ã‚©ãƒ«ãƒ€ä¸‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ã¸è»¢é€ã™ã‚‹æ©Ÿèƒ½ å…·ä½“çš„ã«ã¯ï¼ŒCloudWatch Eventã§å®šæœŸèµ·å‹•ã—ä¸‹è¨˜ã‚’å®Ÿè¡Œã™ã‚‹Lambdaé–¢æ•°ã‚’é–‹ç™º  Dropbox APIã‚’å©ã„ã¦ç‰¹å®šãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾— å½“è©²ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ï¼ŒS3ã®ç‰¹å®šãƒã‚±ãƒƒãƒˆã«ä¿å­˜ ãƒã‚±ãƒƒãƒˆä¿å­˜ãŒæˆåŠŸã—ãŸå ´åˆï¼ŒDropboxå´ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤    çµŒç·¯  ä»¥å‰S3ã«å…¥ã£ã¦ããŸç”»åƒã‚’è§£æã—ã¦Pixelaã«è¨˜éŒ²ã™ã‚‹Lambaé–¢æ•°ã‚’é–‹ç™º  Garmin connectã®ã‚¹ãƒˆãƒ¬ã‚¹æ¸¬å®šçµæœã‚’Pixela + Serverlessã§è‰åŒ– - qrunch.net   ã“ã®éš›ï¼ŒiPhoneã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’S3ã¸é€ã‚‹æ‰‹æ®µã‚’ä¸‹è¨˜ã®ã‚ˆã†ã«æ§‹ç¯‰  IFTTTã§iOSã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’Dropboxã«å…¥ã‚Œï¼ŒZapierã§Dropboxã‹ã‚‰S3ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‚ˆã†ã«ã—ã¦å‰ã«ä½œã£ãŸã‚¹ãƒˆãƒ¬ã‚¹è‰åŒ–Lambdaã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«é€£æºã™ã‚‹ã‚ˆã†ã«ã—ãŸï¼ã¡ã‚‡ã£ã¨çµŒç”±ã—ã™ããªæ°—ã‚‚ã™ã‚‹ã‘ã©ã²ã¨ã¾ãšâ€¦\n\u0026mdash; JagiJagiJagi (@jagijagijag1) November 8, 2018 \r ã—ã‹ã—ãªãŒã‚‰ï¼Œã“ã‚Œã ã‘ã®ãŸã‚ã«Zapierã«èª²é‡‘ã™ã‚‹ã®ã‚‚è¾›ã„ã®ã§ï¼Œã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚’å¦¥å”ã—ã¦å®šæœŸå®Ÿè¡Œã§Dropboxâ†’S3è»¢é€æ©Ÿèƒ½ã‚’å®Ÿç¾ã—ã¦ã¿ãŸ ã“ã‚Œã«ã‚ˆã‚Šï¼ŒZapierã‚’çµŒç”±ã›ãšï¼ŒiPhoneã‹ã‚‰Pixelaã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµåˆ  ç’°å¢ƒ  MacOS Mojave Go 1.11.5 Serverless Framework 1.38.0  ãƒ©ã‚¤ãƒ–ãƒ©ãƒªé¸æŠ  Dropboxã®Goãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä»¥ä¸‹ã®2ã¤ã‚’ç™ºè¦‹  GitHub - dropbox/dropbox-sdk-go-unofficial: An UNOFFICIAL Dropbox v2 API SDK for Go GitHub - tj/go-dropbox: Dropbox v2 client for Go.   å‰è€…ã®æ–¹ãŒï¼Œéå…¬å¼ã¨ã„ã„ã¤ã¤ä¸€å¿œDropboxãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé…ä¸‹ã«ã‚ã£ãŸã®ã§ã“ã¡ã‚‰ã‚’é¸æŠ go get github.com/dropbox/dropbox-sdk-go-unofficial/dropbox  å‰æº–å‚™  æ–°è¦Dropboxã‚¢ãƒ—ãƒªã‚’ç™»éŒ²  https://www.dropbox.com/developers/apps   ä½œæˆå¾Œï¼ŒSettingsã‚¿ãƒ–ã®OAuth 2 - Generated access tokenã§\u0026quot;Generate\u0026quot;ã™ã‚‹ã¨ï¼Œ(ãƒ†ã‚¹ãƒˆå‘ã‘)ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—å¯èƒ½  é–‹ç™ºè©³ç´° å…ˆã«ã¤ã¾ã¥ããƒ¡ãƒ¢  Dropbox APIã§ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—ã—ãŸéš›ã®è¿”ã‚Šå€¤ãŒ[]IsMetadataã§ï¼Œãƒ•ã‚¡ã‚¤ãƒ«(FileMetadata)ã¨ã—ã¦æ“ä½œã§ããš  Goã®å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã§FileMetadataã¨ã—ã¦å‡¦ç†ãŒå¯èƒ½ã« è©³ç´°ã¯ã“ã¡ã‚‰   Dropboxã‹ã‚‰å–å¾—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’S3ã«ã‚ãŸã™ãŸã‚ï¼Œä¸‹è¨˜å¤‰æ›æ‰‹é †ã‚’è¸ã‚€å¿…è¦ã‚ã‚Š  æ­£ç›´ãªã¨ã“ã‚Goã®ioå‘¨ã‚Šã‚„Dropboxã®Dwonload/AWSã®ReadSeekCloserã®ä»•æ§˜ã‚’ç†è§£ã—ã¦ã„ãªã„ã®ã§ï¼Œã¨ã‚Šã‚ãˆãš[]byteã‚‰ã—ãã¨ã“ã‚ã‚’å¼•ã£ã“æŠœã„ã¦æ¸¡ã—ãŸã‚‰ã†ã¾ãã„ã£ãŸçŠ¶æ…‹    // download from dropbox dlArg := files.NewDownloadArg(fpath) res, content, err := dbx.Download(dlArg) // extract file content as []byte blob, _ := ioutil.ReadAll(content) // []byte -\u0026gt; Reader f := bytes.NewReader(blob) // Reader -\u0026gt; aws.ReadSeekCloser rs := aws.ReadSeekCloser(f) // S3 PutObject requires aws.ReadSeekCloser as its input body input := \u0026amp;s3.PutObjectInput{ Body: rs, Bucket: aws.String(bucketName), Key: aws.String(fileName), } é–‹ç™ºã®åˆæœŸè¨­å®š  ä½œã£ãŸã‚‚ã®ã¯GitHub $GOHOME/srcé…ä¸‹ã®ä»»æ„ãƒ•ã‚©ãƒ«ãƒ€ã§ä½œæ¥­  $ sls create -t aws-go-dep -p \u0026lt;project-name\u0026gt;  ç”Ÿæˆã•ã‚ŒãŸhelloã¨worldã®2ã¤ã®é–¢æ•°ã¯ä¸è¦ãªã®ã§å‰Šé™¤ dropbox2s3ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨main.goã‚’ä½œæˆ Makefileä¿®æ­£  .PHONY: build clean deploy\rbuild:\rdep ensure -v\renv GOOS=linux go build -ldflags=\u0026quot;-s -w\u0026quot; -o bin/dropbox2s3 dropbox2s3/main.go\rclean:\rrm -rf ./bin ./vendor Gopkg.lock\rdeploy: clean build\rsls deploy --verbose\r serverless.ymlä¿®æ­£  service: dropbox2s3-periodic frameworkVersion: \u0026#34;\u0026gt;=1.28.0 \u0026lt;2.0.0\u0026#34; provider: name: aws runtime: go1.x region: ap-northeast-1 iamRoleStatements: - Effect: \u0026#34;Allow\u0026#34; Action: - \u0026#34;s3:ListBucket\u0026#34; Resource: \u0026#34;*\u0026#34; - Effect: \u0026#34;Allow\u0026#34; Action: - \u0026#34;s3:PutObject\u0026#34; Resource: \u0026#34;*\u0026#34; package: exclude: - ./** include: - ./bin/** functions: dropbox2s3: handler: bin/dropbox2s3 events: - schedule: cron(0 16 * * ? *) environment: TZ: Asia/Tokyo DROPBOX_TOKEN: \u0026lt;your-api-token\u0026gt; IMG_FOLDER_PATH: \u0026lt;target-project-id\u0026gt;  BUCKET_NAME: \u0026lt;your-bucket\u0026gt; timeout: 60 mainé–¢æ•°ä¿®æ­£  å†’é ­ã®å‡¦ç†ã‚’ãƒŠã‚¤ãƒ¼ãƒ–ã«å®Ÿè£…  package main import ( \u0026#34;bytes\u0026#34; \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;io\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;os\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/aws/session\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/aws\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/service/s3\u0026#34; \u0026#34;github.com/aws/aws-lambda-go/lambda\u0026#34; \u0026#34;github.com/dropbox/dropbox-sdk-go-unofficial/dropbox\u0026#34; \u0026#34;github.com/dropbox/dropbox-sdk-go-unofficial/dropbox/files\u0026#34; ) // Handler is our lambda handler invoked by the `lambda.Start` function call func Handler(ctx context.Context) error { // extract env var \tdropboxToken := os.Getenv(\u0026#34;DROPBOX_TOKEN\u0026#34;) imgFolderPath := os.Getenv(\u0026#34;IMG_FOLDER_PATH\u0026#34;) bucketName := os.Getenv(\u0026#34;BUCKET_NAME\u0026#34;) // tansport image from dropbox to s3 \ttransport(dropboxToken, imgFolderPath, bucketName) return nil } func transport(dropboxToken, imgFolderPath, bucketName string) { // dropbox setting \tconfig := dropbox.Config{ Token: dropboxToken, } dbx := files.New(config) // get info under the imgFolderPath folder \targ := files.NewListFolderArg(imgFolderPath) resp, err := dbx.ListFolder(arg) if err != nil { fmt.Println(\u0026#34;err in accesing dropbox folder\u0026#34;) fmt.Println(err) return } // for each file/folder \tfor _, e := range resp.Entries { // use type annotation to cast e (IsMetadata) to file (FileMetadata) \tf, ok := e.(*files.FileMetadata) if ok { // if e is file, download content \tfmt.Println(\u0026#34;find file \u0026#34;, f.Name) fpath := f.Metadata.PathLower dlArg := files.NewDownloadArg(fpath) res, content, err := dbx.Download(dlArg) if err != nil { fmt.Println(\u0026#34;err in downloading file\u0026#34;) fmt.Println(err) return } // and then put it to S3 \terr = putToS3(bucketName, res.Metadata.Name, content) if err == nil { // if successed, remove transported file on dropbox \tdeleteFromDropbox(dbx, fpath) } } } } func putToS3(bucketName, fileName string, content io.ReadCloser) error { // create s3 client \tsess := session.Must(session.NewSession(\u0026amp;aws.Config{ Region: aws.String(\u0026#34;ap-northeast-1\u0026#34;), })) svc := s3.New(sess) // create put-object input \tblob, _ := ioutil.ReadAll(content) f := bytes.NewReader(blob) rs := aws.ReadSeekCloser(f) input := \u0026amp;s3.PutObjectInput{ Body: rs, Bucket: aws.String(bucketName), Key: aws.String(fileName), } // put contet to s3 \t_, err := svc.PutObject(input) if err != nil { fmt.Println(\u0026#34;err in putting object\u0026#34;) fmt.Println(err) return err } fmt.Println(\u0026#34;put object \u0026#34;, fileName, \u0026#34; to \u0026#34;, bucketName) return nil } func deleteFromDropbox(dbx files.Client, filepath string) { delArg := files.NewDeleteArg(filepath) _, err := dbx.Delete(delArg) if err != nil { fmt.Println(\u0026#34;err in downloading file\u0026#34;) fmt.Println(err) return } } func main() { lambda.Start(Handler) } ãƒ‡ãƒ—ãƒ­ã‚¤  ä»¥ä¸‹ã§ãƒ‡ãƒ—ãƒ­ã‚¤  make deploy = make + sls deploy    $ cd \u0026lt;project-name\u0026gt; $ make deploy ","ref":"/blog/posts/2019_03_02/"},{"title":"Cisco AnyConnectã§å†æ¥ç¶šãŒæ•°åç§’ã”ã¨ã«ç¹°ã‚Šè¿”ã•ã‚Œã‚‹å ´åˆã®å¯¾å‡¦","date":"","description":"","body":"ç’°å¢ƒ  Windows 10 Pro 1803 Cisco AnyConnect Secure Mobility Client 4.6.011  ç—‡çŠ¶  Cisco AnyConnectã«ã¦VPNæ¥ç¶šã—ãŸéš›ã«ï¼Œèªè¨¼ãƒ»æ¥ç¶šã¯æˆåŠŸã™ã‚‹ãŒï¼Œãã®å¾Œå†æ¥ç¶š(ãƒ­ã‚°ã§ã¯Reconnecting)ã‚’æ•°ç§’ã€œæ•°åç§’ãŠãã«ç¹°ã‚Šè¿”ã—ç¶šã‘ã‚‹  è§£æ±º 2019/01/24 è¿½è¨˜\n  ãƒãƒ¼ã‚¸ãƒ§ãƒ³4.6.02074ã§ä¿®æ­£æ¸ˆã¿\n https://community.cisco.com/t5/vpn-and-anyconnect/anyconnect-reconnects-with-hyper-v-adapter/m-p/3695961/highlight/true#M146261    ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ããªã„å ´åˆã®æš«å®šå¯¾å¿œç­–ã¯ä»¥ä¸‹\n Windows 10 Proã®Hyper-Væ©Ÿèƒ½ã‚’ç„¡åŠ¹ã«ã™ã‚‹  ref. Windows 10 Hyper-Vã‚’æœ‰åŠ¹/ç„¡åŠ¹ã«ã™ã‚‹æ–¹æ³• - å‚™å¿˜éŒ²   Dockerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå ´åˆï¼ŒDockerè‡ªä½“ã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã¦ã‚‚Hyper-VãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ã‚ã‚Š TODO: Hyper-V(ãŠãã‚‰ãä»®æƒ³ã‚¹ã‚¤ãƒƒãƒ)ã¨AnyConnectã‚’å…±å­˜ã•ã›ã‚‹æ–¹æ³•ã¯ä¸æ˜    ","ref":"/blog/posts/2019_01_22/"},{"title":"ã€Œã‚ã¨ã§èª­ã‚€ã€ã‚’Pixelaã§å¯è¦–åŒ–","date":"","description":"","body":"tl;dr ãªã‚“ã§ã‚‚è‰åŒ–ã§ãã‚‹Webã‚µãƒ¼ãƒ“ã‚¹Pixelaã®åˆ©ç”¨ã«ã¤ã„ã¦ã¤ã¶ã‚„ã„ãŸã¨ã“ã‚ï¼Œä½œè€…ã®a-knowã•ã‚“ã‹ã‚‰ä¸‹è¨˜ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ã„ãŸã ãã¾ã—ãŸï¼\nã†ãŠãŠâ€¦â€¦ã“ã‚Œã¯ã¾ãŸæ–°ã—ã„æ´»èºæ–¹æ³•â€¦ï¼ï¼ãœã²ãƒ–ãƒ­ã‚°ãªã©ã«ã—ã¦ã„ãŸã ããŸã„ã£ï¼ https://t.co/Cz5zrPVG0Q\n\u0026mdash; a-know (@a_know) 2018å¹´12æœˆ1æ—¥\r\ræ­£ç›´ãªã¨ã“ã‚æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆã¯ä½•ã‚‚ãªã„ã®ã§ã™ãŒï¼Œã›ã£ã‹ããªã®ã§Pixelaã®åˆ©ç”¨äº‹ä¾‹ã¨ã—ã¦è¨˜äº‹åŒ–ã—ã¦ã¿ã¾ã—ãŸï¼ã‚„ã£ãŸã“ã¨ã¯ä»¥ä¸‹ã ã‘ã§ã™ï¼\n Pixelaã®Webhookã¨IFTTTã®Instapaperé€£æºã‚’ç”¨ã„ã‚‹ã“ã¨ã§ä¸‹è¨˜ã‚’å®Ÿç¾ã—ï¼Œ\u0026ldquo;ã‚ã¨ã§èª­ã‚€\u0026quot;ã‚’å¯è¦–åŒ–  Instapaperã«æ–°ãŸã«è¨˜äº‹ãŒè¿½åŠ ã•ã‚ŒãŸã‚‰ï¼ŒDecrementã®Webhookã‚’å©ãpixelã‚’èŒ¶è‰²åŒ– Instapaperã«ä¿å­˜ã—ãŸè¨˜äº‹ãŒ(èª­ã¿çµ‚ã‚ã£ã¦)ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚ŒãŸã‚‰ï¼ŒIncrementã®Webhookã‚’å©ãpixelã‚’ç·‘åŒ–    å‹•æ©Ÿï¼šæºœã¾ã£ã¦ã„ãä¸€æ–¹ã®\u0026quot;ã‚ã¨ã§èª­ã‚€\u0026rdquo;  æ°—ã«ãªã£ãŸè¨˜äº‹ãŒã‚ã‚‹ã¨ï¼Œã‚ã¨ã§ã¡ã‚ƒã‚“ã¨èª­ã‚‚ã†ã¨Instapaperã‚„ã¯ã¦ãƒ–ãªã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã«è¨˜äº‹ã‚’æ”¾ã‚Šè¾¼ã‚“ã§ãŠãã®ã¯ã‚ˆãã‚ã‚‹ã‹ãªã¨ ã—ã‹ã—ã“ã®\u0026quot;ã‚ã¨ã§èª­ã‚€\u0026quot;ã¯ï¼Œç©èª­ã‚„ç©ã¿ã‚²ãƒ¼ã‚ˆã‚ã—ãæºœã¾ã£ã¦ã„ãä¸€æ–¹ã«ãªã‚ŠãŒã¡ ã“ã‚Œã«å¯¾ã—ï¼Œä¸‹è¨˜ã®ç‚¹ã‚’å¯è¦–åŒ–ã§ãã‚Œã°æºœã‚è¾¼ã¾ãªã„ãƒ¢ãƒãƒ™ã«ãªã‚‹ã‹ã‚‚ï¼Ÿ  ã©ã‚Œãã‚‰ã„è¨˜äº‹ã‚’ã‚ã¨ã§èª­ã‚€ã¤ã‚‚ã‚Šã§æ”¾ã‚Šè¾¼ã‚“ã§ã„ã‚‹ã‹ (æºœã‚è¾¼ã¿åº¦åˆã„) ã©ã‚Œãã‚‰ã„ã‚ã¨ã§èª­ã‚€ã“ã¨ã«ã—ãŸè¨˜äº‹ã‚’èª­ã‚“ã§ã„ã‚‹ã‹ (æ¶ˆåŒ–åº¦åˆã„)    è§£æ±º(?)ï¼šPixelaã§ã®å¯è¦–åŒ– ä»¥ä¸‹ã®IFTTT Appletã‚’ä½œæˆã—ï¼Œ\u0026ldquo;ã‚ã¨ã§èª­ã‚€\u0026quot;è¨˜äº‹ã®æ•°ã‚’å¯è¦–åŒ–\n Instapaper (If New item saved) -\u0026gt; Webhooks (then Make a web request)  Instapaperéƒ¨åˆ†ã¯ï¼Œäº‹å‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºã—ã¦ãŠãï¼Œæ—¢å­˜ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã™ã‚‹ã®ã¿ Webhooksã§ã¯ï¼ŒPixelaã®Decrement Webhookã‚’å®Ÿè¡Œ  è¨˜äº‹ãŒå¢—ãˆã‚‹ã®ã¯ãƒã‚¬ãƒ†ã‚£ãƒ–æ–¹å‘ãªã®ã§Decrement = èŒ¶è‰²åŒ–     Instapaper (If New archived item) -\u0026gt; Webhooks (then Make a web request)  Instapaperéƒ¨åˆ†ã¯ï¼Œäº‹å‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æºã—ã¦ãŠãï¼Œæ—¢å­˜ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã™ã‚‹ã®ã¿ Webhooksã§ã¯ï¼ŒPixelaã®Increment Webhookã‚’å®Ÿè¡Œ  è¨˜äº‹ãŒæ¸›ã‚‹ã®ã¯ãƒã‚¸ãƒ†ã‚£ãƒ–æ–¹å‘ãªã®ã§Increment = ç·‘åŒ–      Webhooksã®éƒ¨åˆ†ã®è©³ç´°  Pixela API Documentã‚’å‚è€ƒã«ï¼ŒIncrement/Decrementã®Webhookã‚’ä½œã£ã¦ãŠã IFTTTä¸Šã§ã¯ï¼Œ\u0026ldquo;that\u0026quot;å´ã§\u0026quot;Webhooks\u0026quot;ã‚’é¸æŠã—ï¼Œä¸‹è¨˜ãƒ‘ãƒ©ãƒ¡ã‚¿ã‚’è¨­å®š  URL: https://pixe.la/v1/users/\u0026lt;your-user-id\u0026gt;/webhooks/\u0026lt;your-webhook-hash\u0026gt; Method: POST ContentType: application/json Body: blankã§OK    ãŠè©¦ã—ä¸­ï¼šè¨˜äº‹æ•°ã®ç´¯è¨ˆå€¤ã®è‰åŒ–  Pixelaè‡ªä½“ã¯æ—¥ã€…ã®æ•°å€¤ã‚’è¨˜éŒ²ã™ã‚‹ã‚‚ã®ã ãŒï¼Œå‰æ—¥ã®æ•°å€¤ã‚’å¼•ãç¶™ã’ã°ç´¯è¨ˆå€¤ã®å¯è¦–åŒ–ã‚‚å¯èƒ½ã§ã¯ã¨æ€ã„ç«‹ã¤ (ã‚‚ã¯ã‚„è‰ã§å¯è¦–åŒ–ã—ãªãã¦ã‚‚ã„ã„ã®ã§ã™ãŒ) ãã“ã§ï¼Œ1æ—¥1å›ï¼Œå‰æ—¥ã®æ•°å€¤ã‚’å½“æ—¥ã«è¨˜éŒ²ã™ã‚‹å‡¦ç†ã‚’ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§å®Ÿè£…  AWS Lambdaé–¢æ•°ã®å®Ÿè£…ï¼šcumulated-pixela   ã‚ã¨ã¯è¨˜äº‹ãŒè¿½åŠ ã•ã‚ŒãŸã‚‰Incrementï¼Œã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚ŒãŸã‚‰Decrementã™ã‚‹ã‚ˆã†IFTTT Appletã‚’è¨­å®š ç¾åœ¨ãŠè©¦ã—é‹ç”¨ä¸­ï¼Œä¸‹è¨˜ã®ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã«â†’ã‚°ãƒ©ãƒ•ã‹ã‚‰è‰ã‚’æ¶ˆã™ã¨ã„ã†é€†ãƒ¢ãƒãƒ™ã«  ","ref":"/blog/posts/2018_12_02/"},{"title":"Elastic Beanstalkã§ä½œæˆã•ã‚ŒãŸS3 ãƒã‚±ãƒƒãƒˆãŒå‰Šé™¤ã§ããªã„ã¨ãã®å¯¾å¿œ","date":"","description":"","body":"ç¾è±¡  Elastic Beanstalkã‚’ç”¨ã„ã‚‹ã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãªã©ã‚’æ ¼ç´ã™ã‚‹S3ãƒã‚±ãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ ã‚¢ãƒ—ãƒªè‡ªä½“ã‚’å‰Šé™¤ã—ãŸã‚ã¨ã‚‚ãƒã‚±ãƒƒãƒˆãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆï¼ŒS3ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰å‰Šé™¤ã—ã‚ˆã†ã¨ã—ã¦ã‚‚å‰Šé™¤ã§ããªã„å ´åˆã‚ã‚Š  åŸå›   è‡ªå‹•ã§ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ãŠã‚Šï¼Œæ˜ç¤ºçš„ã«å‰Šé™¤ãŒæ‹’å¦ã•ã‚Œã¦ã„ã‚‹  å¯¾ç­–  ãƒã‚±ãƒƒãƒˆã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§\u0026quot;ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™\u0026quot;â†’\u0026quot;ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼\u0026quot;ã‚’é¸æŠã—ï¼Œå³ä¸Šã®\u0026quot;å‰Šé™¤\u0026quot;ã§ãƒãƒªã‚·ãƒ¼ã‚’å‰Šé™¤ ãã®å¾Œï¼Œãƒã‚±ãƒƒãƒˆä¸€è¦§ã«æˆ»ã‚Šï¼Œå†ã³ãƒã‚±ãƒƒãƒˆå‰Šé™¤ã‚’å®Ÿè¡Œã™ã‚Œã°å‰Šé™¤ã•ã‚Œã‚‹ã¯ãš  ","ref":"/blog/posts/2018_11_29/"},{"title":"serverless framworkã§ç”»åƒèªè­˜ã—ã¦é–¢ä¿‚ã™ã‚‹æ˜ ç”»ã‚’æ¨è–¦ã™ã‚‹Slack Botã‚’ä½œã£ãŸã¾ã¨ã‚ (No Server November Challenge)","date":"","description":"","body":"  serverless frameworkã‚’é–‹ç™ºã—ã¦ã„ã‚‹Serverless, Inc.ã®ä¼ç”»ã§ï¼ŒNo Server NovemberãŒé–‹å‚¬ä¸­\n  11æœˆä¸­ã«æ¯é€±èª²é¡ŒãŒå‡ºã•ã‚Œã‚‹\n Challenges that are designed to help experienced users level up, and brand new users get started    githubãƒªãƒã‚¸ãƒˆãƒªã®ãƒªãƒ³ã‚¯ã‚’#noServerNovemberã‚’ã¤ã¶ã‚„ãã¨ãªã«ã‹(official Serverless swag)ã‚‚ã‚‰ãˆã‚‹?\n  Nov 12ã®èª²é¡Œã§ã‚ã‚‹AnimalBotã¨Nov 19ã®èª²é¡Œã§ã‚ã‚‹Slack botã‚’çµ„ã¿åˆã‚ã›ã¦é–‹ç™ºã—ã¦ã¿ãŸã®ã§å†…å®¹ã®ç´¹ä»‹\n Nov 12 AnimalBot: ç”»åƒURLã‚’ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã™ã‚‹ã¨å†™ã£ã¦ã„ã‚‹å‹•ç‰©ã‚’è¿”ä¿¡ã™ã‚‹Twitter Botã‚’ä½œã‚‹èª²é¡Œ Nov 19 Slack bot: /actionã¨ã™ã‚‹ã¨80å¹´å°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ˜ ç”»ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æ•™ãˆã¦ãã‚Œã‚‹Slack Botã‚’ä½œã‚‹èª²é¡Œ    ä½œã£ãŸã‚‚ã®  Slackä¸Šã§Botã«ç”»åƒURLã‚’ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã™ã‚‹ã¨ï¼Œå†™ã£ã¦ã„ã‚‹å†…å®¹ã¨ï¼Œé–¢é€£ã™ã‚‹æ˜ ç”»ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ   ç”»åƒèªè­˜ã«ã¯Amazon Rekognitionã‚’åˆ©ç”¨ æ˜ ç”»æƒ…å ±ã¯The Movie Databaseã‹ã‚‰APIçµŒç”±ã§å–å¾—    çµæœ  çŒ«ã®ç”»åƒã‚’é€ã‚‹ã¨ï¼ŒçŒ«ãŒå†™ã£ã¦ã„ã‚‹ã“ã¨ã¨ï¼Œé–¢é€£æ˜ ç”»ã¨ã—ã¦é­”å¥³ã®å®…æ€¥ä¾¿ã‚’æ•™ãˆã¦ãã‚ŒãŸ  ç’°å¢ƒ  MacOS Mojave Python 3.6.5 Serverless Framework 1.32.0  ã¤ã¾ã¥ããƒ¡ãƒ¢  [Lambdaãƒ—ãƒ­ã‚­ã‚·] POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ¬ä½“ã¯event.bodyã®ä¸­ã«Stringã§ã¯ã„ã‚‹(JSONã˜ã‚ƒãªã„ï¼)ã®ã§ï¼Œevent.bodyé…ä¸‹ã‚’å†åº¦JSONã¨ã—ã¦èª­ã¿è¾¼ã¿ç›´ã™å¿…è¦ã‚ã‚Š  def main(event, context): body_str = event[\u0026#39;body\u0026#39;] ## ã“ã‚Œã ã¨ãŸã ã®æ–‡å­—åˆ— body_json = json.loads(event[\u0026#39;body\u0026#39;]) ## ã“ã‚Œã§JSONã¨ã—ã¦æ‰±ãˆã‚‹ ...  Lambda + Pythonã§ç”»åƒå‡¦ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªPillow(PIL)ã‚’ä½¿ã†å ´åˆï¼Œãƒ­ãƒ¼ã‚«ãƒ«ãŒMac,å®Ÿè¡Œç’°å¢ƒã¯Linuxãƒ™ãƒ¼ã‚¹ã®ãŸã‚ï¼Œãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åŒæ¢±ã—ã¦ã‚‚å‹•ä½œã—ãªã„  ã‚ˆã£ã¦ï¼Œserverless-python-requirementsã‚’ç”¨ã„ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç†ã‚’ã™ã‚‹ (Amazon Linuxã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’åˆ©ç”¨) é–¢é€£ã™ã‚‹è¨­å®šã¯ä»¥ä¸‹    ... provider: name: aws runtime: python3.6 ... plugins: - serverless-python-requirements custom: pythonRequirements: dockerizePip: true ...   Lambdaä¸Šã§ä¸€æ™‚çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸã„å ´åˆã¯å¿…ãš/tmpé…ä¸‹ã‚’æŒ‡å®šã™ã‚‹\n ä»Šå›ã¯URLã§æŒ‡å®šã•ã‚ŒãŸç”»åƒã‚’ä¸€æ—¦Lambdaãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—å‡¦ç† ãã®éš›ï¼Œä¿å­˜å…ˆã¯/tmpä»¥å¤–ã¯ä¸å¯ (æ¨©é™ãªã—)  OSError: [Errno 30] Read-only file system      Slack APIã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Postã™ã‚‹éš›ï¼Œç”»åƒãªã©ã®ä»˜å±æƒ…å ±ã‚’è¨­å®šå¯èƒ½ãªattachmentsã¯ï¼ŒJSONå†…ã§Stringã¨ã—ã¦æ ¼ç´ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„\n ã¤ã¾ã‚Šï¼Œattachmentsã®å€¤ã¯json.dumsã™ã‚‹å¿…è¦ã‚ã‚Š    # ã“ã‚Œã¯OK data_correct = { ... \u0026#34;attachments\u0026#34;: json.dumps([ { \u0026#34;title\u0026#34;: movie_info[\u0026#39;title\u0026#39;], \u0026#34;image_url\u0026#34;: movie_img_url } ]) } # ã“ã‚Œã¯é§„ç›® data_err = { .... \u0026#34;attachments\u0026#34;: [ { \u0026#34;title\u0026#34;: movie_info[\u0026#39;title\u0026#39;], \u0026#34;image_url\u0026#34;: movie_img_url } ] } é–‹ç™ºè©³ç´° ã¤ãã£ãŸã‚‚ã®ã¯GitHub - jagijagijag1/animal-recog-slack-botã§å…¬é–‹\n serverless.yml, handler.pyã‚’ç·¨é›†ã—ï¼Œã²ã¨ã¾ãšBotå‡¦ç†ã‚’ä½œæˆ Slackï¼ŒMovie DBã§ä½œæ¥­ã—ï¼ŒAPI Tokenå–å¾— serverless.ymlã‚’å†åº¦ç·¨é›†ã—ï¼ŒLambdaç’°å¢ƒå¤‰æ•°ã«API Tokenæƒ…å ±  1. Serverless framework + Pythonã§é–‹å§‹ $ sls create -t aws-python3 -p \u0026lt;project-name\u0026gt; serverless.ymlã®ä¿®æ­£  ç’°å¢ƒå¤‰æ•°éƒ¨åˆ†ã¯å¾Œã§åŸ‹ã‚ã‚‹ã®ã§ã²ã¨ã¾ãšãƒ–ãƒ©ãƒ³ã‚¯  service: animal-recog-slack-bot provider: name: aws runtime: python3.6 region: ap-northeast-1 iamRoleStatements: - Effect: \u0026#34;Allow\u0026#34; Action: - \u0026#34;rekognition:DetectLabels\u0026#34; Resource: \u0026#34;*\u0026#34; plugins: - serverless-python-requirements custom: pythonRequirements: dockerizePip: true functions: hello: handler: handler.main events: - http: path: / method: POST environment: OAUTH_TOKEN: \u0026#39;\u0026#39; BOT_TOKEN: \u0026#39;\u0026#39; MOVIE_DB_API_TOKEN: \u0026#39;\u0026#39; timeout: 20 é–¢æ•°æœ¬ä½“ã‚’ä½œæˆ   ã‚„ã‚„é•·ã„ã®ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰å‚ç…§\n  ç”»åƒã¯URLã§å—ä»˜ï¼Œä¸€æ—¦Lambdaé–¢æ•°ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ï¼ŒRekognitionã«Byteã¨ã—ã¦å—ã‘æ¸¡ã™\n  Rekognitionã§ã¯ã‹ãªã‚Šä¸€èˆ¬çš„ãªå˜èª(e.g. Animal, Pet)ã‚’ãƒ©ãƒ™ãƒ«å€™è£œã®ä¸Šä½ã«å‡ºã—ã¦ãã‚‹ãŸã‚ï¼Œæš«å®šå‡¦ç†ã¨ã—ã¦NGãƒ¯ãƒ¼ãƒ‰(ignore_word)ã‚’è¨­å®šã—å›é¿\n  é–¢é€£æ˜ ç”»ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã®æ¦‚è¦ã¯ä»¥ä¸‹\n Rekognitionã®ãƒ©ãƒ™ãƒ«æ¤œå‡ºçµæœã‹ã‚‰ä¸€èªã‚’é¸æŠ é¸æŠã—ãŸå¾ŒãŒMovie DBã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª(API: /search/keyword)ã—ï¼Œç™»éŒ²ã‚ã‚Šã®å ´åˆã¯IDå–å¾— (ãªã—ã®å ´åˆã¯çµ‚äº†) ç²å¾—ã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰IDã‚’ç”¨ã„ã¦æ˜ ç”»æ¤œç´¢(API: /discover/movie?with_keyword=) æ¤œç´¢çµæœã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã—ãŸæ˜ ç”»ã‚’Slackã«è¿”ã™    ãƒ‡ãƒ—ãƒ­ã‚¤ $ sls plugin install -n serverless-python-requirements $ docker pull lambci``/lambda``:build-python3.6 $ sls deploy -v 2. Slackï¼ŒMovie DBã§ä½œæ¥­ã—ï¼ŒAPI Tokenå–å¾— Slack appæº–å‚™  Building Slack apps | Slackã§Create ãã®å¾Œã®ç”»é¢ã§å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®\u0026quot;Bot User\u0026quot;ã‚’é¸ã³ï¼ŒBot Userã‚’è¿½åŠ  å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼\u0026quot;Event Subscriptions\u0026quot;ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’æœ‰åŠ¹ã«ã—ï¼Œ\u0026ldquo;Request URL\u0026quot;ã«API Gatewayã®URLã‚’æŒ‡å®šã—ï¼ŒchallengeãŒå¸°ã£ã¦ãã‚‹ã“ã¨ã‚’ç¢ºèª (Lambdaã‚³ãƒ¼ãƒ‰ã«å‡¦ç†ã‚’åŸ‹ã‚è¾¼ã¿æ¸ˆ) challengeæˆåŠŸå¾Œï¼Œ\u0026ldquo;Subscribe to Bot Events\u0026quot;ã§\u0026quot;app_mention\u0026quot;ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ  å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼\u0026quot;Installed App\u0026quot;ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚’Workspaceã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« å·¦ãƒ¡ãƒ‹ãƒ¥ã€ŒOAuth \u0026amp; Permissionsã€ã«ã¦Workspaceã«Appã‚’Installã™ã‚‹ã¨\u0026quot;OAuth Access Token\u0026quot;ã¨\u0026quot;Bot User OAuth Access Token\u0026quot;ãŒç™ºè¡Œã•ã‚Œã‚‹ (ã‚ã¨ã§serverless.ymlã«è¿½è¨˜)  Movie DBæº–å‚™  ç™»éŒ²ã—ï¼ŒSettingã‹ã‚‰ç”³è«‹å¯èƒ½  å‚è€ƒï¼šAPI Docs   ç”³è«‹å®Œäº†å¾Œã‚‚Setting-\u0026gt;APIã§APIã‚­ãƒ¼ã‚’ç¢ºèªå¯èƒ½  æœ¬ã‚¢ãƒ—ãƒªã§ã¯v3 authåˆ©ç”¨    3. serverless.ymlã‚’å†åº¦ç·¨é›†ã—ï¼ŒLambdaç’°å¢ƒå¤‰æ•°ã«API Tokenæƒ…å ±ã‚’è¿½è¨˜  OAUTH_TOKEN: Slackã®OAuth Access Token BOT_TOKEN: Slackã®Bot User OAuth Access Token MOVIE_DB_API_TOKEN: The Movie Databaseã®APIã‚­ãƒ¼ (v3 auth)  ... functions: hello: ... environment: OAUTH_TOKEN: \u0026lt;your-token\u0026gt; BOT_TOKEN: \u0026lt;your-token\u0026gt; MOVIE_DB_API_TOKEN: \u0026lt;your-token\u0026gt; ...  å‚è€ƒ  slack boté–‹ç™º  AWSåˆå¿ƒè€…ã§ã‚‚ã‚ã‹ã‚‹ï¼ ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Œçµï¼ AWS+Slack Event APIã‚’ä½¿ã£ãŸSlackãƒœãƒƒãƒˆè¶…å…¥é–€ - Qiita    ","ref":"/blog/posts/2018_11_24/"},{"title":"Togglã®è¨˜éŒ²ã‚’Serverless + Pixelaã§è‰åŒ–","date":"","description":"","body":" ä½œæ¥­æ™‚é–“ãªã©ã®æ™‚é–“ç®¡ç†ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦TogglãŒã‚ã‚‹  ã„ã¤ï¼Œã©ã®ä½œæ¥­ã‚’ã—ãŸã‹ã‚’è¨˜éŒ² å„ä½œæ¥­ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„ã‚¿ã‚°ã§åˆ†é¡å¯èƒ½ Toggl Reportsã§å¯è¦–åŒ–ã‚‚æä¾›ã•ã‚Œã¦ãŠã‚Šï¼Œç‰¹å®šã®ä½œæ¥­ã‚’ã©ã‚Œãã‚‰ã„ç¶™ç¶šã—ã¦ã„ã‚‹ã‹ï¼Œã©ã®ãã‚‰ã„æ™‚é–“ã‚’ã‹ã‘ã¦ã„ã‚‹ã‹ã‚’è¦‹ã‚Œã‚‹ ã§ã‚‚ã¨ã‚Šã‚ãˆãšè‰åŒ–ã—ãŸã„ï¼   Toggleã¯APIã‚’æä¾›ã—ã¦ã„ã‚‹ã®ã§æ¯”è¼ƒçš„ç”¨æ„ã«ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºå¯èƒ½  ç”»åƒèªè­˜ã¨ã‹ã„ã‚‰ãªã„ï¼    ä½œã£ãŸã‚‚ã®  1æ—¥1å›ï¼Œå‰æ—¥ã«ç‰¹å®šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‹ã‘ãŸæ™‚é–“ã‚’Togglã‹ã‚‰æŠ½å‡ºã—ï¼ŒPixelaã«è¨˜éŒ²  çµæœ  è‡ªåˆ†ã®å‹‰å¼·æ™‚é–“ã‚’è‰åŒ–ã§ããŸ  ç’°å¢ƒ  MacOS Mojave Go 1.11.1 Serverless Framework 1.32.0  ã¤ã¾ã¥ããƒ¡ãƒ¢  ã—ã‚‡ã¼ã„å†…å®¹ã ãŒå‚™å¿˜éŒ²ã¨ã—ã¦  Lambdaã«ã¦æ™‚é–“ã‚’æ‰±ã†å ´åˆã®æ³¨æ„  CloudWatch Eventsã‚’cronå¼ã§æ™‚é–“æŒ‡å®šã™ã‚‹å ´åˆï¼ŒUTCã§æŒ‡å®šã™ã‚‹ã“ã¨  e.g. JSTã§æ¯æ—¥åˆå‰1æ™‚ã«å®Ÿè¡Œã—ãŸã„â†’UTCã§åˆå¾Œ4æ™‚(-9æ™‚é–“)ã‚’æŒ‡å®šã™ã‚‹ cron( 0 16 * * ? * )   Lambdaé–¢æ•°ã§æ—¥æ™‚ã‚’å–å¾—ã™ã‚‹å ´åˆ(e.g. Goã§ã®time.Now())ï¼Œæ¨™æº–ã§ã¯UTCã§å–å¾—ã™ã‚‹ æ—¥æœ¬æ™‚é–“ã‚’ä½¿ã„ãŸã„å ´åˆã¯Lambdaé–¢æ•°ã®ç’°å¢ƒå¤‰æ•°ã§ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨  e.g. å¤‰æ•°TZ, å€¤Asia/Tokyo    Toggl APIã®ä½¿ã„æ–¹  Togglã®APIã‚’åˆ©ç”¨ã—ãŸã„å ´åˆï¼Œãƒªã‚¯ã‚¨ã‚¹ãƒˆã«APIãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ã‚‹  APIãƒˆãƒ¼ã‚¯ãƒ³ã¯Profileã‹ã‚‰å–å¾—å¯èƒ½: https://support.toggl.com/my-profile/   ä»Šå›ã¯ç‰¹å®šæœŸé–“ã®è¨˜éŒ²ã‚’å…¨å–å¾—ã—ï¼Œç‰¹å®šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨˜éŒ²ã®ã¿åŠ ç®—ã—ã¦ã„ãåˆè¨ˆæ™‚é–“ã‚’å–å¾— ç‰¹å®šæœŸé–“ã®è¨˜éŒ²ã‚’å–å¾—ã™ã‚‹APIã¯ä»¥ä¸‹  GET https://www.toggl.com/api/v8/time_entries?start_date=XXX\u0026amp;end_date=XXX æ—¥æ™‚ã¯ISO 8601å½¢å¼   ä»Šå›ã¯Goã®wrapperã§ã‚ã‚‹dougEfresh/gtogglã‚’åˆ©ç”¨  READMEã®è¨˜è¼‰å†…å®¹ã ã¨ã†ã¾ãè¡Œã‹ãš    import \u0026#34;github.com/dougEfresh/gtoggl\u0026#34; import \u0026#34;github.com/dougEfresh/gtoggl-api/gtproject\u0026#34; func main() { // HTTP clientä½œæˆ  thc, err := gthttp.NewClient(\u0026#34;your-api-token\u0026#34;) ... // Togglã®è¨˜éŒ²(time entry)å–å¾—ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆ  tec := gttimeentry.NewClient(thc) // ç‰¹å®šæœŸé–“ã®è¨˜éŒ²ã‚’å–å¾— \tentries, eerr := tec.GetRange(start_date, end_date) } é–‹ç™ºè©³ç´°  ä½œã£ãŸã‚‚ã®ã¯GitHub - jagijagijag1/toggl2pixelaã§å…¬é–‹  Serverless framework + Goã§é–‹å§‹  $GOHOME/srcé…ä¸‹ã§ä½œæ¥­  $ serverless create -t aws-go-dep -p \u0026lt;project-name\u0026gt;  æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„ã®ã§serverless.ymlã«regionã‚’è¿½è¨˜  provider: name: aws runtime: go1.x region: ap-northeast-1  ä»¥ä¸‹ã§ã²ã¨ã¾ãšãƒ‡ãƒ—ãƒ­ã‚¤ãƒ†ã‚¹ãƒˆå¯èƒ½  $ cd \u0026lt;project-name\u0026gt; $ make $ sls deploy æ–°è¦é–¢æ•°ã‚’ä½œæˆ  é–¢æ•°ã‚’æ–°è¦ä½œæˆ  è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸé–¢æ•°ã¯ä¸è¦ãªã®ã§å‰Šé™¤ toggl2pixelaãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ï¼Œmain.goã‚’ä½œæˆ Makefileã®build:ã«ä»¥ä¸‹ã‚’è¿½è¨˜    env GOOS=linux go build -ldflags=\u0026quot;-s -w\u0026quot; -o bin/toggl2pixela toggl2pixela/main.go\rserverless.ymlã®ä¿®æ­£  serverless.ymlã®ä¸»ãªä¿®æ­£ãƒ»è¿½è¨˜ç‚¹ã¯ä»¥ä¸‹  æ–°è¦ä½œæˆã—ãŸé–¢æ•°å®šç¾©ã®è¿½è¨˜ ï¼ˆ+è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸé–¢æ•°å®šç¾©ã®å‰Šé™¤) eventsä¸‹ã«schecule: ***ã‚’æ›¸ãã“ã¨ã§å®šæœŸå®Ÿè¡Œã‚’å®šç¾© (ä¸‹è¨˜ã§ã¯æ¯æ—¥åˆå‰1æ™‚ã«å®Ÿè¡Œï¼Œä¸Šè¿°ã®é€šã‚Šcronå¼ã®æ™‚é–“ã¯UTCæŒ‡å®šãªã®ã§æ³¨æ„) Lambdaé–¢æ•°ã§JSTã§æ—¥æ™‚å–å¾—ã—ãŸã„ã®ã§ï¼Œç’°å¢ƒå¤‰æ•°TZ, å€¤Asia/Tokyoã‚’æŒ‡å®š Lambdaé–¢æ•°ã®ç’°å¢ƒå¤‰æ•°(environment)ã«Togglã®APIã‚­ãƒ¼/å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDï¼ŒPixelaã®ãƒ¦ãƒ¼ã‚¶/ãƒˆãƒ¼ã‚¯ãƒ³/ã‚°ãƒ©ãƒ•æƒ…å ±ã‚’ä¸ãˆã‚‹    service: toggl2pixela frameworkVersion: \u0026#34;\u0026gt;=1.28.0 \u0026lt;2.0.0\u0026#34; provider: name: aws runtime: go1.x region: ap-northeast-1 package: exclude: - ./** include: - ./bin/** functions: toggl2pixela: handler: bin/toggl2pixela events: - schedule: cron(0 16 * * ? *) # you need to fill the followings with your own environment: TZ: Asia/Tokyo TOGGL_API_TOKEN: \u0026lt;your-api-token\u0026gt; TOGGL_PROJECT_ID: \u0026lt;target-project-id\u0026gt;  PIXELA_USER: \u0026lt;user-id\u0026gt; PIXELA_TOKEN: \u0026lt;your-token\u0026gt; PIXELA_GRAPH: \u0026lt;your-graph-id-1\u0026gt; timeout: 10 é–¢æ•°æœ¬ä½“ã‚’ä½œæˆ  ç´ ç›´ã«å®Ÿè£…ã—ãŸã ã‘ãªã®ã§ï¼Œç‰¹è¨˜äº‹é …ãªã—â€¦  ãƒ‡ãƒ¼ã‚¿å…ƒã®Togglï¼Œãƒ‡ãƒ¼ã‚¿æŠ•å…¥å…ˆã®Pixelaã®æƒ…å ±ã¯ç’°å¢ƒå¤‰æ•°(TOGGL_API_TOKEN, TOGGL_PROJECT_ID, PIXELA_USER, PIXELA_TOKEN, PIXELA_GRAPH)ã‹ã‚‰å–å¾— Goã§ã®Togglæ“ä½œã«ã¯dougEfresh/gtogglã‚’åˆ©ç”¨  åˆ©ç”¨æ–¹æ³•ã¯ä¸Šè¿°   Goã§ã®Pixelaæ“ä½œã«ã¯gainings/pixela-go-clientã‚’åˆ©ç”¨    package main import ( \u0026#34;context\u0026#34; \u0026#34;errors\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;os\u0026#34; \u0026#34;strconv\u0026#34; \u0026#34;time\u0026#34; \u0026#34;github.com/aws/aws-lambda-go/lambda\u0026#34; \u0026#34;github.com/dougEfresh/gtoggl-api/gthttp\u0026#34; \u0026#34;github.com/dougEfresh/gtoggl-api/gttimentry\u0026#34; pixela \u0026#34;github.com/gainings/pixela-go-client\u0026#34; ) // Handler is our lambda handler invoked by the `lambda.Start` function call func Handler(ctx context.Context) error { // extract env var \tapiToken := os.Getenv(\u0026#34;TOGGL_API_TOKEN\u0026#34;) pjID, _ := strconv.ParseUint(os.Getenv(\u0026#34;TOGGL_PROJECT_ID\u0026#34;), 10, 64) user := os.Getenv(\u0026#34;PIXELA_USER\u0026#34;) token := os.Getenv(\u0026#34;PIXELA_TOKEN\u0026#34;) graph := os.Getenv(\u0026#34;PIXELA_GRAPH\u0026#34;) // extract data from toggl \tdate, quantity := getDateAndTimeFromToggl(apiToken, pjID) if date == \u0026#34;-1\u0026#34; || quantity == \u0026#34;-1\u0026#34; { return errors.New(\u0026#34;Error in accessing toggl\u0026#34;) } fmt.Printf(\u0026#34;date: %s, quantity: %s\\n\u0026#34;, date, quantity) // record pixel \tperr := recordPixel(user, token, graph, date, quantity) if perr != nil { return errors.New(\u0026#34;Error in accessing pixela\u0026#34;) } return nil } func getDateAndTimeFromToggl(apiToken string, pjID uint64) (string, string) { // create toggl client \tthc, err := gthttp.NewClient(apiToken) if err != nil { fmt.Println(err) return \u0026#34;-1\u0026#34;, \u0026#34;-1\u0026#34; } // set time range to be analyzed \ty := time.Now().AddDate(0, 0, -1) s := time.Date(y.Year(), y.Month(), y.Day(), 0, 0, 0, 0, time.Local) e := time.Date(y.Year(), y.Month(), y.Day(), 23, 59, 59, 0, time.Local) date := y.Format(\u0026#34;20060102\u0026#34;) // get time entries \ttotal := int64(0) tec := gttimeentry.NewClient(thc) entries, eerr := tec.GetRange(s, e) if eerr != nil { fmt.Println(eerr) return \u0026#34;-1\u0026#34;, \u0026#34;-1\u0026#34; } // sum durations with project pjID \tfor _, e := range entries { if e.Pid == pjID { total += e.Duration } } totalMin := float64(total) / 60 quantity := strconv.FormatFloat(totalMin, \u0026#39;f\u0026#39;, 4, 64) return date, quantity } func recordPixel(user, token, graph, date, quantity string) error { c := pixela.NewClient(user, token) // try to record \terr := c.RegisterPixel(graph, date, quantity) if err == nil { fmt.Println(\u0026#34;recorded\u0026#34;) return err } // if fail, try to update \terr = c.UpdatePixelQuantity(graph, date, quantity) if err == nil { fmt.Println(\u0026#34;updated\u0026#34;) } return err } func main() { lambda.Start(Handler) } ","ref":"/blog/posts/2018_11_10/"},{"title":"CAV 2018ã§ã®AWSæ‹›å¾…è¬›æ¼”ã®ã¾ã¨ã‚","date":"","description":"","body":"Formal Reasoning About the Security of Amazon Web Services å½¢å¼æ‰‹æ³•ã«é–¢ã™ã‚‹ãƒˆãƒƒãƒ—ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ã‚ã‚‹CAV 2018ã«ã¦ï¼ŒAWSã‹ã‚‰è¬›æ¼”(Invited Paperã®ç™ºè¡¨)ãŒã‚ã‚Šã¾ã—ãŸï¼\nãã“ã§ã®ç™ºè¡¨ã‹ã‚‰AWSã¯å½¢å¼æ‰‹æ³•ã«ã‹ãªã‚ŠåŠ›ã‚’å…¥ã‚Œã¦ã„ã‚‹å°è±¡ã‚’å—ã‘ï¼Œå‰²ã¨é‡è¦ãªå†…å®¹ã‹ãªã¨æ€ã„ï¼Œå˜ãªã‚‹ç®‡æ¡æ›¸ãã§ã™ãŒæŠœç²‹ãƒ»ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸï¼ æœˆä¸¦ã¿ã§ã™ãŒAWSã‚‚ä¸­ã®äººé”ã‚‚ã¾ã˜ã™ã”ã„ï¼\nè‘—è€…(ç™ºè¡¨è€…)/æ‰€å±æ©Ÿé–¢ Byron Cook (Amazon Web Services, University College London)\nå‡ºå…¸ FLoC 2018 (CAV 2018)\n FLoC Plenary Lecture (CAV 2018 Invited Paper)  AWSã§ã®å½¢å¼æ‰‹æ³•ã®æ´»ç”¨ã«ã¤ã„ã¦ Open Accessã®ãŸã‚â†“ã§é–²è¦§å¯èƒ½  Formal Reasoning About the Security of Amazon Web Services | SpringerLink   è¬›æ¼”ã®æ˜ åƒã‚‚â†“ã‹ã‚‰è¦–è´å¯èƒ½  Formal Reasoning about the Security of Amazon Web Services | University of Oxford Podcasts - Audio and Video Lectures      å†…å®¹  AWSã§ã¯åˆ†æ•£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨­è¨ˆã«å½¢å¼æ‰‹æ³•(TLA+)ã‚’ä½¿ç”¨ (2014) ãã®å¾Œã‚‚ç¶™ç¶šçš„ã«å½¢å¼æ‰‹æ³•ã‚’å–ã‚Šå…¥ã‚Œã„ã¦ã„ã‚‹ã‚ˆã†ã§ï¼Œæœ¬è«–æ–‡ã§ã¯ç‰¹ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¸ã®å½¢å¼æ‰‹æ³•é©ç”¨äº‹ä¾‹ã‚’ç´¹ä»‹  Security of the Cloud: Where Formal Reasoning Fits In  AWSå†…éƒ¨ã®é–‹ç™ºï¼Œç‰¹ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å®šç†è¨¼æ˜ã‚„ãƒ¢ãƒ‡ãƒ«æ¤œæŸ»(symbolic model checking)ã®åˆ©ç”¨ãŒå¢—ãˆã¦ã„ã‚‹ 2017å¹´ã ã‘ã§ã‚‚ä¸‹è¨˜ã®äº‹ä¾‹ã«ã¦å®šç†è¨¼æ˜ã‚„ãƒ¢ãƒ‡ãƒ«æ¤œæŸ»ã‚’é©ç”¨  s2n (TLS/SSLå®Ÿè£…)ã®æ¤œè¨¼  ã¡ãªã¿ã«ã“ã®å†…å®¹ã®è«–æ–‡ãŒåŒä¼šè­°ã«ã¦ç™ºè¡¨ã•ã‚Œã¦ã„ã‚‹ Continuous Formal Verification of Amazon s2n | SpringerLink   ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ï¼Œãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ï¼ŒBIOSï¼Œãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®æ¤œè¨¼  ã“ã£ã¡ã‚‚åŒä¼šè­°ã§ç™ºè¡¨ã‚ã‚Š Model Checking Boot Code from AWS Data Centers | SpringerLink   ã‚¬ãƒ¼ãƒ™ãƒƒã‚¸ã‚³ãƒ¬ã‚¯ã‚¿ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­è¨ˆ   OSSã‚’æ´»ç”¨ã—ã¤ã¤ä½¿ã†ä¸Šã§ç”Ÿã˜ãŸå¤‰æ›´ã‚’ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã—ã¦ãŠã‚Šï¼Œä¾‹ãˆã°ä¸‹è¨˜ã‚’åˆ©ç”¨+è²¢çŒ®  CBMC: C/C++å‘ã‘ã®bounded model checker SAW: Cã‚„Jabaã§ã®ç‰¹å®šæ€§è³ªã®æ¤œè¨¼ SMACK: Cãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å¯¾ã™ã‚‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³æ¤œè¨¼   s2nãªã©ä¸€éƒ¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯å½¢å¼æ¤œè¨¼ãƒ„ãƒ¼ãƒ«ã‚’CI/CDã«çµ„ã¿è¾¼ã¿ï¼Œç¶™ç¶šçš„æ¤œè¨¼ã‚’å®Ÿæ–½ SMT-basedã®ãƒ„ãƒ¼ãƒ«ã§è¨­å®šãƒŸã‚¹é˜²æ­¢ã‚’å›³ã£ã¦ã„ã‚‹ å½¢å¼æ‰‹æ³•ã®åˆ©ç”¨ã¯ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã‹ã‚‰å§‹ã¾ã£ã¦ã„ã‚‹ï¼ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨­è¨ˆæ®µéšã‹ã‚‰åˆ©ç”¨  Securing Customers in the Cloud  AWSåˆ©ç”¨è€…å´ã«å¯¾ã—ã¦ã‚‚å½¢å¼æ‰‹æ³•ã®é©ç”¨ãŒå§‹ã¾ã£ã¦ã„ã‚‹  ä¾‹ãˆã°ï¼ŒS3ã®å…¬é–‹è¨­å®šãƒŸã‚¹ã‚’è­¦å‘Šã™ã‚‹æ©Ÿèƒ½ã‚’SMTã‚½ãƒ«ãƒã‚’ç”¨ã„ã¦å®Ÿç¾  ãŠãã‚‰ãâ†“ã®è©± How AWS uses automated reasoning to help you achieve security at scale | AWS Security Blog   AWS Macieã§ã‚‚åŒæ§˜ã®ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ è¤‡é›‘ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šæ™‚ã®åˆ°é”æ€§(ãŠãã‚‰ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„é€šä¿¡å¯å¦)ã‚’datalogã‚’ç”¨ã„ã¦æ¤œè¨¼    ãã®ä»–  ä»–ç¤¾äº‹ä¾‹(æ–‡çŒ®)ã¨ã—ã¦ä»¥ä¸‹ã«è¨€åŠ (æŠœç²‹)  IBM, Google @ Dagstuhl Seminar 2013 Microsoft @ SOSP 2015 åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã®æ¤œè¨¼ Facebook @ LICS 2018 codebaseã®ç¶™ç¶šçš„æ¤œè¨¼    æ„Ÿæƒ³  TLA+ã®é©ç”¨ã«å§‹ã¾ã‚Šï¼ŒAWSã¯å½¢å¼æ‰‹æ³•ã®é©ç”¨ã«å¯¾ã—ç¶™ç¶šçš„ã«åŠ›ã‚’å…¥ã‚Œã„ã¦ã„ã‚‹å°è±¡ ç‰¹ã«ä»Šå›ã¯ï¼Œå½¢å¼æ¤œè¨¼ã®ãƒˆãƒƒãƒ—ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ã‚ã‚‹CAVã«ã¦2æœ¬ã®è«–æ–‡æ¡æŠ+Invited talkã‚’ã—ã¦ãŠã‚ŠæŠœãã‚“å‡ºã¦ã„ã‚‹ ã“ã†ã„ã£ãŸä¼šè­°ã§ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹ã‚’ä¸Šã’ã‚‹ã“ã¨ã§ï¼ŒAWSåˆ©ç”¨æ™‚ã®å®‰å¿ƒåº¦ãƒ»ä¿¡é ¼æ„ŸãŒé«˜ã¾ã‚‹ç´ æ™´ã‚‰ã—ã„å–ã‚Šçµ„ã¿ ã“ã‚Œã ã‘ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ ã§å½¢å¼æ‰‹æ³•ãŒåˆ©ç”¨ã•ã‚Œã‚‹/é–‹ç™ºè€…ã‚‚TLA+ãªã©ã‚’ä½¿ãˆã‚‹ã¨ã“ã‚ã‚’è¦‹ã‚‹ã«ï¼Œä¸­ã®äººãŒã¡ã‚ƒã‚“ã¨Computer Scienceã®ç´ é¤Šã‚’æŒã£ã¦ã„ã¦å„ªç§€ãªæ¨¡æ§˜  ","ref":"/blog/posts/2018_11_07/"},{"title":"Garmin connectã®ã‚¹ãƒˆãƒ¬ã‚¹æ¸¬å®šçµæœã‚’Pixela + Serverlessã§è‰åŒ–","date":"","description":"","body":"  Garmin connectã§ã¯å¿ƒæ‹æ•°ã®è¨ˆæ¸¬ã‚’ã‚‚ã¨ã«ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ•°å€¤åŒ–ã—ã¦ãã‚Œã‚‹\n  ã‚¢ãƒ—ãƒªå†…ã§ã¯ï¼Œä¸€è¦§ã§ã¿ãŸã„ã¨ãã«æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã—ã‹ãªã„ + æœ€å¤§4é€±é–“åˆ†ã—ã‹è¦‹ã‚Œãªã„\n  åˆ¥ã®å¯è¦–åŒ–æ–¹æ³•ã¨ã—ã¦è‰åŒ–ã—ã¦ã¿ãŸã„\n  ä½œã£ãŸã‚‚ã®   Garmin connectã®ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ï¼Œæ—¥ä»˜ã¨ã‚¹ãƒˆãƒ¬ã‚¹å€¤ã‚’Pixelaã«è¨˜éŒ²ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ \n  2018/11/17 è¿½è¨˜ï¼š ä¸‹è¨˜ã‚’ç”¨ã„ã‚Œã°iOSã§ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–ã‚‹ã ã‘ã§Pixelaã«è¨˜éŒ²ã§ãã¾ã™ï¼ (iOSâ†’Dropbox by IFTTT + Dropboxâ†’S3 by Zapierï¼‰\n Add your latest iPhone screenshots to a Dropbox folder Amazon S3 + Dropbox Integrations  çµæœï¼šã„ã„æ„Ÿã˜ã«è‰åŒ–ã§ããŸæ°—ãŒã™ã‚‹   ç›´è¿‘ã®ã‚¹ãƒˆãƒ¬ã‚¹ãŒé«˜ã„ï¼Œæ—¥æ›œã¯æ¯”è¼ƒçš„ã‚¹ãƒˆãƒ¬ã‚¹ãŒå°‘ãªã„\n  ãªã‚‹ã¹ãè‰²ãŒã¤ã‹ãªã„(è–„ããªã‚‹)ã‚ˆã†ã«ã—ãŸã„ã¨ã„ã†é€†ãƒ¢ãƒãƒ™\n  ç’°å¢ƒ  MacOS Mojave Go 1.11.1 Serverless Framework 1.32.0 iPhone 7(iOS 12.01) + Garmin Connect 4.12.0.14  Pixelaã¸ã®ãƒ‡ãƒ¼ã‚¿æŠ•å…¥æ–¹æ³•ã®æ¤œè¨  iOS ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢  Garmin connectã®ã‚¢ãƒ—ãƒªã‹ã‚‰é€£æºã•ã‚Œãªã„   Garminã®å…¬å¼API (2ç¨®é¡)  Garmin Health API  å…¨ãƒ‡ãƒ¼ã‚¿å–å¾—å¯èƒ½ã‹ã¤ç„¡æ–™ã ãŒï¼Œä¼æ¥­å‘ã‘ã®ãŸã‚åˆ©ç”¨ä¸å¯   Garmin Connect API  å€‹äººåˆ©ç”¨å¯ã ãŒï¼Œãƒ•ã‚£ãƒƒãƒˆãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒå¯¾è±¡ã‹ã¤æœ‰æ–™($5,000)     ã‚¢ãƒ—ãƒªç”»é¢ã‹ã‚‰æŠ½å‡º   ã‚¢ãƒ—ãƒªç”»é¢ã‚’éƒ½åº¦ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹å¿…è¦ã‚ã‚Š\n  APIãŒãªãã¦ã‚‚ï¼Œç›´ã«æƒ…å ±ã‚’æŠ½å‡ºå¯èƒ½\n  Amazon Rekognitionã§è©¦ã—ãŸæ„Ÿã˜ï¼Œè¡Œã‘ãã†\n    é–‹ç™ºè©³ç´°  ä½œã£ãŸã‚‚ã®ã¯jagijagijag1/GarminStress2Pixelaã§å…¬é–‹  Serverless framework + Goã§é–‹å§‹  $GOHOME/srcé…ä¸‹ã§ä½œæ¥­  $ serverless create -t aws-go-dep -p \u0026lt;project-name\u0026gt;  æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„ã®ã§serverless.ymlã«regionã‚’è¿½è¨˜  provider: name: aws runtime: go1.x region: ap-northeast-1  ä»¥ä¸‹ã§ã²ã¨ã¾ãšãƒ‡ãƒ—ãƒ­ã‚¤ãƒ†ã‚¹ãƒˆå¯èƒ½  $ cd \u0026lt;project-name\u0026gt; $ make $ sls deploy æ–°è¦é–¢æ•°ã‚’ä½œæˆ  é–¢æ•°ã‚’æ–°è¦ä½œæˆ  è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸé–¢æ•°ã¯ä¸è¦ãªã®ã§å‰Šé™¤ garmin-stress2pixelaãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ï¼Œmain.goã‚’ä½œæˆ Makefileã®build:ã«ä»¥ä¸‹ã‚’è¿½è¨˜    env GOOS=linux go build -ldflags=\u0026quot;-s -w\u0026quot; -o bin/garmin-stress2pixela garmin-stress2pixela/main.go\rserverless.ymlã®ä¿®æ­£  serverless.ymlã®ä¸»ãªä¿®æ­£ãƒ»è¿½è¨˜ç‚¹ã¯ä»¥ä¸‹  IAM Roleã«Rekognitionã®DetectTextå®Ÿè¡Œè¨±å¯ã¨ï¼Œç”»åƒã‚’æŠ•å…¥ã™ã‚‹S3ãƒã‚±ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’è¿½è¨˜ æ–°è¦ä½œæˆã—ãŸé–¢æ•°å®šç¾©ã®è¿½è¨˜ ï¼ˆ+è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸé–¢æ•°å®šç¾©ã®å‰Šé™¤)  eventsä¸‹ã®s3: \u0026lt;bucket-name\u0026gt;ã¯å­˜åœ¨ã—ãªã„ãƒã‚±ãƒƒãƒˆåã¨ã™ã‚‹ã“ã¨ (sls deployã§æ–°è¦ä½œæˆã•ã‚Œã‚‹ãŸã‚) Lambdaé–¢æ•°ã®ç’°å¢ƒå¤‰æ•°(environment)ã«Pixelaã®ãƒ¦ãƒ¼ã‚¶/ãƒˆãƒ¼ã‚¯ãƒ³/ã‚°ãƒ©ãƒ•æƒ…å ±ã‚’ä¸ãˆã‚‹      service: GarminStress2Pixela frameworkVersion: \u0026#34;\u0026gt;=1.28.0 \u0026lt;2.0.0\u0026#34; provider: name: aws runtime: go1.x region: ap-northeast-1 # you can add statements to the Lambda function\u0026#39;s IAM Role here iamRoleStatements: - Effect: \u0026#34;Allow\u0026#34; Action: - \u0026#34;rekognition:DetectText\u0026#34; Resource: \u0026#34;*\u0026#34; - Effect: \u0026#34;Allow\u0026#34; Action: - \u0026#34;s3:GetObject\u0026#34; Resource: [ \u0026#34;arn:aws:s3:::pixela-datasource-stress-img-bucket\u0026#34;, \u0026#34;arn:aws:s3:::pixela-datasource-stress-img-bucket/*\u0026#34; ] package: exclude: - ./** include: - ./bin/** functions: garmin-stress2pixela: handler: bin/garmin-stress2pixela events: - s3: \u0026lt;bucket-name\u0026gt; # you need to fill the followings with your own environment: PIXELA_USER: \u0026lt;user-id\u0026gt; PIXELA_TOKEN: \u0026lt;your-token\u0026gt; PIXELA_GRAPH: \u0026lt;your-graph-id-1\u0026gt; timeout: 10 é–¢æ•°æœ¬ä½“ã‚’ä½œæˆ  ä½œã£ã¦ã„ã‚‹æœ€ä¸­ã®æ°—ã¥ãï¼Œãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹  Goã§ã®AWSã‚¤ãƒ™ãƒ³ãƒˆã¯ä»¥ä¸‹ã«ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚Šï¼Œã“ã‚Œã‚’å‚ç…§ã—Handlerã®å¼•æ•°ï¼Œå…¥åŠ›æƒ…å ±å‡¦ç†ã‚’å®Ÿè£…  aws-lambda-go/events at master aws/aws-lambda-go GitHub   InvalidS3ObjectException ã«å½“ãŸã£ãŸ  InvalidS3ObjectException: Unable to get object metadata from S3. Check object key, region and/or access permissions. S3 Objectã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’Lambadé–¢æ•°ã«ã‚‚ä»˜ä¸ã™ã‚‹ã“ã¨ (ä¸Šè¨˜yamlã«ã¦æ¸ˆ) S3ãƒã‚±ãƒƒãƒˆã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ï¼ŒRekognitionã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åŒã˜ã«ã™ã‚‹ã“ã¨  Rekognitionã¯åŒä¸€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒã‚±ãƒƒãƒˆå†…ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã—ã‹ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„æ¨¡æ§˜     [ä½œã‚Šè¾¼ã¿ãƒ»æ±ç”¨æ€§ä½] æ—¥ä»˜ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹å€¤ã¯ï¼Œäº‹å‰ã«ç”»åƒå†…ã§ã®æƒ³å®šä½ç½®ã‚’ä¸ãˆï¼ŒRekognition.DetectTextã®çµæœã®ã†ã¡ï¼Œæƒ³å®šä½ç½®ã®æœ€ã‚‚è¿‘å‚ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’é¸æŠ  æƒ³å®šä½ç½®(assumedDatePoint, assumedQuantityPoint)ã¯iPhone 7(iOS 12.01)ï¼ŒGarmin Connect 4.12.0.14ã«ã¦å®Ÿé¨“çš„ã«æŠ½å‡º   ãƒ‡ãƒ¼ã‚¿æŠ•å…¥å…ˆã®Pixelaã®æƒ…å ±ã¯ç’°å¢ƒå¤‰æ•°(PIXELA_USER, PIXELA_TOKEN, PIXELA_GRAPH)ã‹ã‚‰å–å¾— Goã§ã®Pixelaæ“ä½œã«ã¯gainings/pixela-go-clientã‚’åˆ©ç”¨    package main import ( \u0026#34;context\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;math\u0026#34; \u0026#34;os\u0026#34; \u0026#34;regexp\u0026#34; \u0026#34;strings\u0026#34; \u0026#34;github.com/aws/aws-lambda-go/events\u0026#34; \u0026#34;github.com/aws/aws-lambda-go/lambda\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/aws\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/aws/session\u0026#34; \u0026#34;github.com/aws/aws-sdk-go/service/rekognition\u0026#34; pixela \u0026#34;github.com/gainings/pixela-go-client\u0026#34; ) // Point is left \u0026amp; top positions of bounding box in the Rekognition result type Point struct { Left float64 Top float64 } // !! fixed number from experiment (maybe require to change your env) !! var assumedDatePoint = Point{Left: 0.393, Top: 0.111} var assumedQuantityPoint = Point{Left: 0.268, Top: 0.282} // Handler is our lambda handler invoked by the `lambda.Start` function call func Handler(ctx context.Context, s3Event events.S3Event) error { // for each s3 object \tfor _, record := range s3Event.Records { // extract s3 object info \tbucket, key := getS3ObjectFromRecord(record) fmt.Printf(\u0026#34;[%s] Bucket = %s, Key = %s \\n\u0026#34;, record.EventSource, bucket, key) // execute text detection of Rekognition \tres, rekerr := exeRekognitionDetectText(bucket, key) if rekerr != nil { fmt.Println(\u0026#34;Error\u0026#34;) fmt.Println(rekerr.Error()) } // extract date \u0026amp; quantity from the above result \tdate, quantity := getValueFromRekognitionResult(res.TextDetections) fmt.Printf(\u0026#34;data: %s, quantity: %s\\n\u0026#34;, date, quantity) // record pixel \tperr := recordPixel(date, quantity) fmt.Println(perr) } return nil } func getS3ObjectFromRecord(record events.S3EventRecord) (string, string) { s := record.S3 bucket := s.Bucket.Name rep := regexp.MustCompile(`[+]`) key := rep.ReplaceAllString(s.Object.Key, \u0026#34; \u0026#34;) return bucket, key } func exeRekognitionDetectText(bucket, key string) (*rekognition.DetectTextOutput, error) { // create Rekognition client \tsess := session.Must(session.NewSession()) rc := rekognition.New(sess, aws.NewConfig().WithRegion(\u0026#34;ap-northeast-1\u0026#34;)) // set params \tparams := \u0026amp;rekognition.DetectTextInput{ Image: \u0026amp;rekognition.Image{ S3Object: \u0026amp;rekognition.S3Object{ Bucket: aws.String(bucket), Name: aws.String(key), }, }, } fmt.Printf(\u0026#34;params: %s\u0026#34;, params) // execute DetectText \treturn rc.DetectText(params) } func getValueFromRekognitionResult(results []*rekognition.TextDetection) (string, string) { dateHypot, quantityHypot := math.MaxFloat64, math.MaxFloat64 date, quantity := \u0026#34;\u0026#34;, \u0026#34;\u0026#34; // for each detected text \tfor _, td := range results { left, top := *td.Geometry.BoundingBox.Left, *td.Geometry.BoundingBox.Top // calc hypot with assumed date pos \u0026amp; update value \ttmpDHypot := math.Hypot(math.Abs(left-assumedDatePoint.Left), math.Abs(top-assumedDatePoint.Top)) if tmpDHypot \u0026lt; dateHypot { // if td is most-likely-result (nearest to the assumed point), keep the result (with removing \u0026#34;/\u0026#34;) \tdateHypot, date = tmpDHypot, strings.Replace(*td.DetectedText, \u0026#34;/\u0026#34;, \u0026#34;\u0026#34;, -1) } // calc hypot with assumed quantity pos \u0026amp; update value \ttmpQHypot := math.Hypot(math.Abs(left-assumedQuantityPoint.Left), math.Abs(top-assumedQuantityPoint.Top)) if tmpQHypot \u0026lt; quantityHypot { // if td is most-likely-result (nearest to the assumed point), keep the result \tquantityHypot, quantity = tmpQHypot, *td.DetectedText } } return date, quantity } func recordPixel(date, quantity string) error { user := os.Getenv(\u0026#34;PIXELA_USER\u0026#34;) token := os.Getenv(\u0026#34;PIXELA_TOKEN\u0026#34;) graph := os.Getenv(\u0026#34;PIXELA_GRAPH\u0026#34;) c := pixela.NewClient(user, token) // try to record \terr := c.RegisterPixel(graph, date, quantity) if err == nil { fmt.Println(\u0026#34;recorded\u0026#34;) return err } // if fail, try to update \terr = c.UpdatePixelQuantity(graph, date, quantity) if err == nil { fmt.Println(\u0026#34;updated\u0026#34;) } return err } func main() { lambda.Start(Handler) } ","ref":"/blog/posts/2018_10_28/"}]